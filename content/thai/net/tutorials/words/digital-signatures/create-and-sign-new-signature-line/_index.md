---
title: สร้างและลงนามบรรทัดลายเซ็นใหม่
linktitle: สร้างและลงนามบรรทัดลายเซ็นใหม่
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้วิธีการเพิ่มลายเซ็นดิจิทัลลงในเอกสาร Word ของคุณอย่างราบรื่นโดยใช้ Aspose.Words สำหรับ .NET บทช่วยสอนที่ครอบคลุมนี้ครอบคลุมทุกอย่างตั้งแต่การตั้งค่าสภาพแวดล้อมและการแทรกบรรทัดลายเซ็นไปจนถึงการบันทึกและตรวจยืนยันเอกสารที่ลงนามของคุณ
type: docs
weight: 10
url: /th/net/tutorials/words/digital-signatures/create-and-sign-new-signature-line/
---
## การแนะนำ

ต้องการเพิ่มลายเซ็นดิจิทัลในเอกสาร Word หรือไม่ ด้วย Aspose.Words สำหรับ .NET คุณสามารถทำได้ง่ายกว่าที่คิด! บทช่วยสอนนี้จะแนะนำคุณเกี่ยวกับขั้นตอนต่างๆ ในการตั้งค่าสภาพแวดล้อม การเพิ่มบรรทัดลายเซ็น และการลงนามในเอกสารแบบดิจิทัล มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1.  Aspose.Words สำหรับ .NET -[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา .NET - Visual Studio เหมาะอย่างยิ่งสำหรับงานนี้
3. เอกสารที่ต้องลงนาม - คุณสามารถสร้างเอกสาร Word ใหม่หรือใช้เอกสารที่มีอยู่แล้วก็ได้
4.  แฟ้มใบรับรอง-ก`.pfx` ไฟล์นี้จำเป็นสำหรับลายเซ็นดิจิทัล
5. รูปภาพบรรทัดลายเซ็น (ทางเลือก) - คุณสามารถรวมไฟล์รูปภาพสำหรับลายเซ็นได้

## นำเข้าเนมสเปซที่จำเป็น

ในการใช้ฟังก์ชันการทำงานของ Aspose.Words คุณจำเป็นต้องนำเข้าเนมสเปซต่อไปนี้:

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## ขั้นตอนที่ 1: การตั้งค่าไดเรกทอรีเอกสาร

เริ่มต้นด้วยการกำหนดเส้นทางไปยังไดเร็กทอรีเอกสารของคุณ ซึ่งจะเป็นตำแหน่งที่คุณจะบันทึกและเรียกค้นเอกสารของคุณ

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // ระบุเส้นทางไดเร็กทอรีเอกสารของคุณ
```

## ขั้นตอนที่ 2: การสร้างเอกสารใหม่

ต่อไปเราจะสร้างเอกสาร Word ใหม่ เอกสารนี้จะทำหน้าที่เป็นพื้นที่สำหรับบรรทัดลายเซ็นของคุณ

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## ขั้นตอนที่ 3: การแทรกบรรทัดลายเซ็น

 ตอนนี้ใช้`DocumentBuilder` คลาสที่จะแทรกบรรทัดลายเซ็นลงในเอกสารของคุณ:

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## ขั้นตอนที่ 4: การบันทึกเอกสาร

เมื่อคุณแทรกบรรทัดลายเซ็นแล้ว ให้บันทึกเอกสาร นี่เป็นขั้นตอนสำคัญก่อนการลงนาม

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## ขั้นตอนที่ 5: การกำหนดค่าตัวเลือกการลงนาม

ตั้งค่าตัวเลือกสำหรับกระบวนการลงนาม ซึ่งรวมถึงการระบุ ID บรรทัดลายเซ็นและรูปภาพที่จะแสดงพร้อมกับลายเซ็น

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf") // เส้นทางสู่ภาพของคุณ
};
```

## ขั้นตอนที่ 6: การโหลดใบรับรอง

โหลดไฟล์ใบรับรองที่จำเป็นสำหรับการลงนามเอกสาร:

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "your_certificate.pfx", "your_password"); // ปรับแต่งชื่อไฟล์และรหัสผ่าน
```

## ขั้นตอนที่ 7: การลงนามในเอกสาร

 สุดท้ายให้ลงนามในเอกสารโดยใช้`DigitalSignatureUtil` ชั้นเรียน บันทึกเอกสารที่ลงนามด้วยชื่อใหม่เพื่อใช้ในการอ้างอิงในอนาคต

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.SignedDocument.docx", certHolder, signOptions);
```

## บทสรุป

ขอแสดงความยินดี! คุณได้สร้างเอกสาร Word สำเร็จแล้ว เพิ่มบรรทัดลายเซ็น และเซ็นชื่อแบบดิจิทัลโดยใช้ Aspose.Words สำหรับ .NET เครื่องมืออันทรงพลังนี้ช่วยลดความซับซ้อนของการทำงานอัตโนมัติของเอกสาร ทำให้มั่นใจได้ว่าสัญญาและเอกสารทางการของคุณได้รับการเซ็นชื่อและรับรองอย่างปลอดภัย

## คำถามที่พบบ่อย

### ฉันสามารถใช้รูปแบบภาพอื่นสำหรับบรรทัดลายเซ็นได้หรือไม่

ใช่ คุณสามารถใช้รูปแบบภาพต่างๆ ได้ เช่น PNG, JPG และ BMP

###  จำเป็นต้องใช้หรือไม่`.pfx` file for the certificate?

 ใช่ครับ`.pfx` ไฟล์เป็นรูปแบบมาตรฐานสำหรับการจัดเก็บใบรับรองและคีย์ส่วนตัวสำหรับลายเซ็นดิจิทัล

### ฉันสามารถเพิ่มบรรทัดลายเซ็นหลายบรรทัดในเอกสารเดียวได้หรือไม่

แน่นอน! คุณสามารถแทรกบรรทัดลายเซ็นหลายบรรทัดได้โดยทำซ้ำขั้นตอนการแทรกตามต้องการ

### จะเกิดอะไรขึ้นหากฉันไม่มีใบรับรองดิจิทัล?

คุณจะต้องได้รับใบรับรองดิจิทัลจากผู้มีอำนาจออกใบรับรองที่เชื่อถือได้ หรือสร้างใบรับรองขึ้นมาโดยใช้เครื่องมือเช่น OpenSSL

### ฉันจะตรวจสอบลายเซ็นดิจิทัลในเอกสารได้อย่างไร

คุณสามารถตรวจสอบลายเซ็นดิจิทัลได้โดยเปิดเอกสารที่ลงนามใน Word และตรวจสอบรายละเอียดลายเซ็นเพื่อยืนยันความถูกต้องและสมบูรณ์