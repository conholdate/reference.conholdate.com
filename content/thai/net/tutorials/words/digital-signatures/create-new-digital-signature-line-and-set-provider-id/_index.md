---
title: สร้างบรรทัดลายเซ็นดิจิทัลใหม่และตั้งค่ารหัสผู้ให้บริการ
linktitle: สร้างบรรทัดลายเซ็นดิจิทัลใหม่และตั้งค่ารหัสผู้ให้บริการ
second_title: API การประมวลผลเอกสาร Aspose.Words
description: ค้นพบวิธีการเพิ่มบรรทัดลายเซ็นในเอกสาร Word ของคุณโดยใช้โปรแกรม Aspose.Words สำหรับ .NET คำแนะนำที่ครอบคลุมนี้ครอบคลุมทุกอย่างตั้งแต่การตั้งค่าสภาพแวดล้อมการพัฒนาของคุณไปจนถึงการแทรกบรรทัดลายเซ็นและการลงนามในเอกสารอย่างปลอดภัย
type: docs
weight: 10
url: /th/net/tutorials/words/digital-signatures/create-new-digital-signature-line-and-set-provider-id/
---
## การแนะนำ

สวัสดีผู้ชื่นชอบเทคโนโลยี! คุณเคยต้องการทำให้การรวมบรรทัดลายเซ็นเป็นอัตโนมัติในเอกสาร Word ของคุณหรือไม่ วันนี้เราจะมาเจาะลึกวิธีการทำสิ่งนี้โดยใช้ Aspose.Words สำหรับ .NET คำแนะนำทีละขั้นตอนนี้จะแนะนำคุณตลอดขั้นตอนการสร้างบรรทัดลายเซ็นและการตั้งค่า ID ผู้ให้บริการ ซึ่งจะทำให้กระบวนการประมวลผลเอกสารของคุณมีประสิทธิภาพและคล่องตัวมากขึ้น

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเริ่มต้น เรามาตรวจสอบกันก่อนว่าคุณได้ตั้งค่าทุกอย่างเรียบร้อยแล้ว:

1.  Aspose.Words สำหรับ .NET: หากคุณยังไม่ได้ติดตั้ง โปรดดาวน์โหลด[ที่นี่](https://releases.aspose.com/words/net/).
2. สภาพแวดล้อมการพัฒนา: ใช้ Visual Studio หรือการตั้งค่าการพัฒนา C# ใดๆ
3. .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET Framework ไว้ในเครื่องของคุณแล้ว
4. ใบรับรอง PFX: คุณจะต้องมีใบรับรอง PFX สำหรับการลงนามเอกสาร ซึ่งสามารถขอได้จากผู้มีอำนาจออกใบรับรองที่เชื่อถือได้

## การนำเข้าเนมสเปซที่จำเป็น

ในการเริ่มต้น ให้นำเข้าเนมสเปซที่จำเป็นลงในโครงการ C# ของคุณ:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Signing;
using System;
```

ตอนนี้มาดูรายละเอียดการสร้างบรรทัดลายเซ็นใหม่และการตั้งค่า ID ผู้ให้บริการกัน

## ขั้นตอนที่ 1: สร้างเอกสารใหม่

ขั้นแรก เราต้องสร้างเอกสาร Word ใหม่ ซึ่งจะทำหน้าที่เป็นพื้นที่สำหรับบรรทัดลายเซ็นของเรา:

```csharp
// ระบุเส้นทางไปยังไดเร็กทอรีเอกสารของคุณ
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

 ที่นี่เราจะเริ่มต้นใหม่`Document` และก`DocumentBuilder`ซึ่งช่วยให้เราเพิ่มองค์ประกอบต่างๆ ได้อย่างง่ายดาย

## ขั้นตอนที่ 2: กำหนดตัวเลือกบรรทัดลายเซ็น

ต่อไปเราจะกำหนดตัวเลือกสำหรับบรรทัดลายเซ็นของเรา รวมถึงชื่อผู้ลงนาม ตำแหน่ง อีเมล และรายละเอียดที่เกี่ยวข้องอื่นๆ:

```csharp
SignatureLineOptions signatureLineOptions = new SignatureLineOptions
{
    Signer = "vderyushev",
    SignerTitle = "QA",
    Email = "vderyushev@aspose.com",
    ShowDate = true,
    DefaultInstructions = false,
    Instructions = "Please sign here.",
    AllowComments = true
};
```

ตัวเลือกเหล่านี้ช่วยปรับแต่งบรรทัดลายเซ็นให้ชัดเจนและเป็นมืออาชีพ

## ขั้นตอนที่ 3: แทรกบรรทัดลายเซ็น

เมื่อมีตัวเลือกพร้อมแล้ว เราสามารถแทรกบรรทัดลายเซ็นลงในเอกสารได้:

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(signatureLineOptions).SignatureLine;
signatureLine.ProviderId = Guid.Parse("CF5A7BB4-8F3C-4756-9DF6-BEF7F13259A2");
```

 การ`InsertSignatureLine`วิธีการเพิ่มบรรทัดลายเซ็น และเรากำหนด ID ผู้ให้บริการเฉพาะให้กับบรรทัดนั้น

## ขั้นตอนที่ 4: บันทึกเอกสาร

หลังจากแทรกบรรทัดลายเซ็นแล้ว ให้บันทึกเอกสารดังนี้:

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLineProviderId.docx");
```

การดำเนินการนี้จะบันทึกเอกสารของคุณโดยมีบรรทัดลายเซ็นที่เพิ่มใหม่

## ขั้นตอนที่ 5: ตั้งค่าตัวเลือกการลงนาม

ตอนนี้ เราจะกำหนดค่าตัวเลือกการลงนาม รวมถึง ID บรรทัดลายเซ็น ID ผู้ให้บริการ ความคิดเห็น และเวลาการลงนาม:

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    ProviderId = signatureLine.ProviderId,
    Comments = "Document was signed by vderyushev",
    SignTime = DateTime.Now
};
```

การตั้งค่าเหล่านี้ช่วยให้แน่ใจว่าเอกสารได้รับการลงนามด้วยรายละเอียดที่ถูกต้อง

## ขั้นตอนที่ 6: สร้างผู้ถือใบรับรอง

ในการลงนามในเอกสาร เราจำเป็นต้องสร้างผู้ถือใบรับรองโดยใช้ใบรับรอง PFX:

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

 แทนที่`"morzal.pfx"` ด้วยชื่อไฟล์ใบรับรองจริงของคุณและ`"aw"` ด้วยรหัสผ่านใบรับรองของคุณ

## ขั้นตอนที่ 7: ลงนามในเอกสาร

สุดท้ายเราจะลงนามในเอกสารโดยใช้ยูทิลิตี้ลายเซ็นดิจิทัล:

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLineProviderId.docx", 
    dataDir + "SignDocuments.CreateNewSignatureLineAndSetProviderId.docx", certHolder, signOptions);
```

กระบวนการนี้จะลงนามในเอกสารและบันทึกเป็นไฟล์ใหม่

## บทสรุป

ขอแสดงความยินดี! คุณได้สร้างบรรทัดลายเซ็นและกำหนด ID ของผู้ให้บริการในเอกสาร Word สำเร็จแล้วโดยใช้ Aspose.Words สำหรับ .NET ไลบรารีอันทรงพลังนี้ช่วยลดความซับซ้อนของงานประมวลผลเอกสาร ทำให้เวิร์กโฟลว์ของคุณมีประสิทธิภาพมากขึ้น ลองใช้ดูและดูว่าไลบรารีนี้สามารถปรับปรุงโครงการของคุณได้อย่างไร!

## คำถามที่พบบ่อย

### ฉันสามารถปรับแต่งลักษณะของเส้นลายเซ็นได้หรือไม่?
 แน่นอน! คุณสามารถปรับเปลี่ยนตัวเลือกต่างๆ ได้ใน`SignatureLineOptions` เพื่อให้เหมาะกับสไตล์และความต้องการของคุณ

### จะเกิดอะไรขึ้นหากฉันไม่มีใบรับรอง PFX?
คุณจะต้องได้รับใบรับรองจากผู้มีอำนาจออกใบรับรองที่เชื่อถือได้ เนื่องจากถือเป็นสิ่งสำคัญสำหรับการลงนามเอกสารแบบดิจิทัล

### ฉันสามารถเพิ่มบรรทัดลายเซ็นหลายบรรทัดลงในเอกสารได้หรือไม่
ใช่ คุณสามารถเพิ่มบรรทัดลายเซ็นหลายบรรทัดได้โดยทำซ้ำขั้นตอนการแทรกด้วยตัวเลือกที่แตกต่างกัน

### Aspose.Words สำหรับ .NET เข้ากันได้กับ .NET Core หรือไม่
ใช่ Aspose.Words สำหรับ .NET รองรับ .NET Core ทำให้มีความยืดหยุ่นสำหรับสภาพแวดล้อมการพัฒนาต่างๆ

### ลายเซ็นดิจิทัลมีความปลอดภัยแค่ไหน?
ลายเซ็นดิจิทัลที่สร้างด้วย Aspose.Words มีความปลอดภัยสูง โดยขอให้คุณใช้ใบรับรองที่ถูกต้องและเชื่อถือได้