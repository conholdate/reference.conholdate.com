---
title: การผนวกข้อความจากส่วนที่คั่นหน้าไว้ในเอกสาร Word
linktitle: การผนวกข้อความจากส่วนที่คั่นหน้าไว้ในเอกสาร Word
second_title: API การประมวลผลเอกสาร Aspose.Words
description: เรียนรู้วิธีการผนวกข้อความจากส่วนที่คั่นหน้าในเอกสาร Word ได้อย่างราบรื่นด้วย Aspose.Words สำหรับ .NET บทช่วยสอนแบบทีละขั้นตอนนี้
type: docs
weight: 10
url: /th/net/tutorials/words/mastering-bookmarks/append-text-from-bookmarked-sections/
---
## การแนะนำ

คุณเคยพบว่าการผนวกข้อความจากส่วนที่คั่นหน้าไว้ในเอกสาร Word เป็นเรื่องท้าทายหรือไม่ คุณมาถูกที่แล้ว! บทช่วยสอนนี้จะแนะนำคุณตลอดกระบวนการทีละขั้นตอนโดยใช้ Aspose.Words สำหรับ .NET เมื่อเสร็จสิ้น คุณจะสามารถผนวกข้อความที่คั่นหน้าไว้ได้อย่างมืออาชีพ มาเริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึก ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

-  Aspose.Words สำหรับ .NET: หากคุณยังไม่ได้ติดตั้ง คุณสามารถทำได้[ดาวน์โหลดได้ที่นี่](https://releases.aspose.com/words/net/).
- สภาพแวดล้อมการพัฒนา: สภาพแวดล้อมการพัฒนา .NET เช่น Visual Studio
- ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับแนวคิดการเขียนโปรแกรม C# ขั้นพื้นฐานจะเป็นประโยชน์
- เอกสาร Word ที่มีบุ๊กมาร์ก: เอกสาร Word ที่มีบุ๊กมาร์กซึ่งเราจะใช้ในการผนวกข้อความจากนั้น

## นำเข้าเนมสเปซที่จำเป็น

ขั้นแรก เราต้องนำเข้าเนมสเปซที่จำเป็นเพื่อเข้าถึงฟังก์ชันการทำงานของ Aspose.Words

```csharp
using System;
using Aspose.Words;
using Aspose.Words.Importing;
```

## ขั้นตอนที่ 1: โหลดเอกสารและกำหนดค่าตัวแปร

เริ่มต้นด้วยการโหลดเอกสาร Word ต้นทางและปลายทางและกำหนดค่าตัวแปรที่จำเป็น

```csharp
//โหลดเอกสารต้นทางและปลายทาง
Document srcDoc = new Document("source.docx");
Document dstDoc = new Document("destination.docx");

// เริ่มต้นตัวนำเข้าเอกสาร
NodeImporter importer = new NodeImporter(srcDoc, dstDoc, ImportFormatMode.KeepSourceFormatting);

// ค้นหาบุ๊กมาร์กในเอกสารต้นฉบับ
Bookmark srcBookmark = srcDoc.Range.Bookmarks["YourBookmarkName"];
```

## ขั้นตอนที่ 2: ระบุย่อหน้าเริ่มต้นและย่อหน้าสิ้นสุด

ขั้นต่อไป เราต้องระบุตำแหน่งย่อหน้าที่บุ๊กมาร์กเริ่มต้นและสิ้นสุด ซึ่งเป็นสิ่งสำคัญสำหรับการแยกข้อความที่ถูกต้อง

```csharp
// ระบุย่อหน้าที่จุดเริ่มต้นและจุดสิ้นสุดของบุ๊กมาร์ก
Paragraph startPara = (Paragraph)srcBookmark.BookmarkStart.ParentNode;
Paragraph endPara = (Paragraph)srcBookmark.BookmarkEnd.ParentNode;

// ตรวจสอบความถูกต้องของย่อหน้า
if (startPara == null || endPara == null)
    throw new InvalidOperationException("Bookmark start or end does not have a valid paragraph parent.");
```

## ขั้นตอนที่ 3: ตรวจสอบผู้ปกครองย่อหน้า

เราต้องแน่ใจว่าทั้งย่อหน้าเริ่มต้นและย่อหน้าสิ้นสุดใช้โหนดหลักเดียวกัน ซึ่งเป็นแนวทางที่เรียบง่ายเพื่อหลีกเลี่ยงความยุ่งยาก

```csharp
// ตรวจสอบว่าย่อหน้าเริ่มต้นและย่อหน้าสิ้นสุดมีผู้ปกครองเดียวกันหรือไม่
if (startPara.ParentNode != endPara.ParentNode)
    throw new InvalidOperationException("Start and end paragraphs must have the same parent.");
```

## ขั้นตอนที่ 4: ระบุโหนดที่จะหยุด

ตอนนี้ เราต้องกำหนดว่าจะหยุดคัดลอกข้อความที่ใด ซึ่งจะเป็นโหนดทันทีหลังย่อหน้าสุดท้าย

```csharp
// ระบุโหนดทันทีหลังย่อหน้าท้าย
Node endNode = endPara.NextSibling;
```

## ขั้นตอนที่ 5: ผนวกข้อความที่คั่นหน้าไว้ในเอกสารปลายทาง

ในที่สุด เราจะวนซ้ำผ่านโหนดจากย่อหน้าเริ่มต้นไปยังโหนดหลังย่อหน้าสิ้นสุด และผนวกเข้ากับเอกสารปลายทาง

```csharp
for (Node curNode = startPara; curNode != endNode; curNode = curNode.NextSibling)
{
    // นำเข้าโหนดปัจจุบันเข้าสู่เอกสารปลายทาง
    Node newNode = importer.ImportNode(curNode, true);

    // ผนวกโหนดที่นำเข้าไปยังเอกสารปลายทาง
    dstDoc.FirstSection.Body.AppendChild(newNode);
}

// บันทึกเอกสารปลายทางอัปเดต
dstDoc.Save("appended_document.docx");
```

## บทสรุป

ขอแสดงความยินดี! คุณได้ผนวกข้อความจากส่วนที่คั่นหน้าในเอกสาร Word สำเร็จแล้วโดยใช้ Aspose.Words สำหรับ .NET ไลบรารีอันทรงพลังนี้ทำให้การจัดการเอกสารเป็นเรื่องง่าย และตอนนี้คุณก็มีทักษะที่มีประโยชน์อีกอย่างในชุดเครื่องมือของคุณแล้ว ขอให้สนุกกับการเขียนโค้ด!

## คำถามที่พบบ่อย

### ฉันสามารถผนวกข้อความจากบุ๊กมาร์กหลาย ๆ อันพร้อมกันได้ไหม
ใช่ คุณสามารถทำซ้ำขั้นตอนสำหรับแต่ละบุ๊กมาร์กและผนวกข้อความตามต้องการได้

### จะเกิดอะไรขึ้นถ้าย่อหน้าเริ่มต้นและย่อหน้าสิ้นสุดมีผู้ปกครองต่างกัน?
ตัวอย่างปัจจุบันถือว่ามีผู้ปกครองคนเดียวกัน หากไม่มี คุณจะต้องใช้การจัดการที่ซับซ้อนกว่านี้

### รูปแบบดั้งเดิมของข้อความผนวกจะถูกเก็บรักษาไว้หรือไม่?
 แน่นอน! ใช้`ImportFormatMode.KeepSourceFormatting`ทำให้แน่ใจว่ารูปแบบดั้งเดิมยังคงได้รับการรักษาไว้

### สามารถผนวกข้อความในตำแหน่งที่ระบุในเอกสารปลายทางได้หรือไม่
ใช่ คุณสามารถผนวกข้อความในตำแหน่งใดๆ ที่ต้องการได้โดยการนำทางไปยังโหนดที่เหมาะสมในเอกสารปลายทาง

### ฉันสามารถผนวกข้อความจากบุ๊กมาร์กไปยังส่วนใหม่ได้หรือไม่
ใช่ คุณสามารถสร้างส่วนใหม่ในเอกสารปลายทางและผนวกข้อความไว้ที่นั่นได้