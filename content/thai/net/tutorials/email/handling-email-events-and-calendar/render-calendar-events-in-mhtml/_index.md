---
title: เรนเดอร์กิจกรรมปฏิทินใน MHTML โดยใช้ Aspose.Email
linktitle: เรนเดอร์กิจกรรมปฏิทินใน MHTML โดยใช้ Aspose.Email
second_title: API การประมวลผลอีเมล Aspose.Email .NET
description: เรนเดอร์กิจกรรมปฏิทินในรูปแบบ MHTML โดยใช้ Aspose.Email สำหรับ .NET เรียนรู้ทีละขั้นตอนเกี่ยวกับการปรับแต่งและบันทึกไฟล์ MSG ด้วย C#
type: docs
weight: 15
url: /th/net/tutorials/email/handling-email-events-and-calendar/render-calendar-events-in-mhtml/
---
## การแนะนำ

Aspose.Email สำหรับ .NET เป็นไลบรารีที่มีประสิทธิภาพสำหรับการจัดการงานที่เกี่ยวข้องกับอีเมลในแอปพลิเคชัน .NET กรณีการใช้งานที่น่าสนใจกรณีหนึ่งคือการแสดงเหตุการณ์ปฏิทินด้วยโปรแกรมโดยใช้ C# ไม่ว่าคุณจะกำลังสร้างฟีเจอร์การรวมปฏิทินหรือสร้างโปรแกรมดูอีเมลแบบกำหนดเอง บทช่วยสอนนี้จะแนะนำคุณตลอดการแสดงเหตุการณ์ปฏิทินในรูปแบบ MHTML ด้วยความแม่นยำและการปรับแต่ง

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่มต้น เรามาตรวจสอบให้แน่ใจก่อนว่าเราพร้อมทุกอย่างแล้วสำหรับการปฏิบัติตามบทช่วยสอนนี้:

1.  Aspose.Email สำหรับไลบรารี .NET: ดาวน์โหลดไลบรารีเวอร์ชันล่าสุดจาก[หน้าดาวน์โหลด Aspose.Email สำหรับ .NET](https://releases.aspose.com/email/net/).
2. สภาพแวดล้อมการพัฒนา: Visual Studio (หรือ C# IDE ที่คุณต้องการ) ติดตั้งบนระบบของคุณ
3. ใบอนุญาต: รับใบอนุญาตที่ถูกต้องสำหรับ Aspose.Email เพื่อวัตถุประสงค์ในการประเมิน คุณสามารถใช้[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/).
4.  ไฟล์ MSG ตัวอย่าง: ไฟล์ MSG กิจกรรมปฏิทิน คุณสามารถใช้ไฟล์ใดก็ได้`.msg` ไฟล์ที่มีกิจกรรมในปฏิทิน เช่น "การประชุมที่มีเหตุการณ์ที่เกิดขึ้นซ้ำ"

## แพ็คเกจนำเข้า

ในการเริ่มต้น ให้รวมเนมสเปซที่จำเป็นในโครงการของคุณ 

```csharp
using System;
using Aspose.Email;
using Aspose.Email.Mht;
```

ตอนนี้ เรามาดูคำแนะนำทีละขั้นตอนกันเลย!

## ขั้นตอนที่ 1: โหลดไฟล์ MSG เหตุการณ์ปฏิทิน

ขั้นแรก เราโหลดไฟล์ MSG ที่มีกิจกรรมในปฏิทิน ขั้นตอนนี้มีความสำคัญเนื่องจากเป็นอินพุตสำหรับการแสดงกิจกรรมในรูปแบบ MHTML


```csharp
string dataDir = "Your Data Directory";
string fileName = "Meeting with Recurring Occurrences.msg";

// โหลดไฟล์ MSG
MailMessage msg = MailMessage.Load(dataDir + fileName);
```

- `dataDir`: ระบุไดเร็กทอรีที่จัดเก็บไฟล์ MSG ของคุณ
- `fileName`: ชื่อของไฟล์กิจกรรมปฏิทิน
- `MailMessage.Load` : อ่านไฟล์และโหลดลงใน`MailMessage` วัตถุ.

## ขั้นตอนที่ 2: กำหนดค่าตัวเลือกการบันทึก MHTML

ขั้นตอนต่อไปคือการกำหนดค่าตัวเลือกสำหรับการเรนเดอร์กิจกรรมปฏิทินเป็นรูปแบบ MHTML ซึ่งรวมถึงการเปิดใช้งานรูปแบบ ส่วนหัว และคุณสมบัติอื่นๆ ที่เฉพาะเจาะจงสำหรับการปรับแต่ง

```csharp
MhtSaveOptions options = new MhtSaveOptions
{
    MhtFormatOptions = MhtFormatOptions.WriteHeader | MhtFormatOptions.RenderCalendarEvent
};
```

- `MhtSaveOptions`หมายถึงการตั้งค่าสำหรับการบันทึกไฟล์ MHTML
- `MhtFormatOptions`: กำหนดค่าตัวเลือกต่างๆ เช่น การรวมส่วนหัว และการเรนเดอร์เหตุการณ์ปฏิทิน

## ขั้นตอนที่ 3: ปรับแต่งเทมเพลตการแสดงผล

ที่นี่ เราจะกำหนดว่าคุณสมบัติเฉพาะ เช่น เวลาเริ่มต้นของเหตุการณ์ ควรปรากฏในผลลัพธ์อย่างไร ขั้นตอนนี้จะช่วยให้สามารถกำหนดผลลัพธ์ได้เองและอ่านได้


```csharp
if (options.FormatTemplates.ContainsKey(MhtTemplateName.Start))
    options.FormatTemplates[MhtTemplateName.Start] = @"<span class='headerLineTitle'>Start:</span><span class='headerLineText'>{0}</span><br/>";
else
    options.FormatTemplates.Add(MhtTemplateName.Start, @"<span class='headerLineTitle'>Start:</span><span class='headerLineText'>{0}</span><br/>");
```

- `MhtTemplateName.Start`:หมายถึงคุณสมบัติ "เริ่มต้น" ของเหตุการณ์ปฏิทิน
- `options.FormatTemplates`: ปรับแต่งเทมเพลตการแสดงผลสำหรับคุณสมบัติเฉพาะ

## ขั้นตอนที่ 4: บันทึกเหตุการณ์ปฏิทินเป็น MHTML

สุดท้าย ให้บันทึกกิจกรรมปฏิทินไปยังไฟล์ MHTML พร้อมตัวเลือกที่กำหนดค่าไว้


```csharp
msg.Save(dataDir + "Meeting with Recurring Occurrences.mhtml", options);
```

- `msg.Save`: บันทึกข้อความในรูปแบบและตำแหน่งที่ระบุ
- `Meeting with Recurring Occurrences.mhtml`: ชื่อไฟล์เอาท์พุต

## บทสรุป

การเรนเดอร์กิจกรรมปฏิทินโดยใช้ Aspose.Email สำหรับ .NET มีประสิทธิภาพและปรับแต่งได้สูง เมื่อทำตามขั้นตอนข้างต้น คุณสามารถแปลงกิจกรรมปฏิทินเป็นไฟล์ MHTML ได้อย่างราบรื่นพร้อมการจัดรูปแบบที่ปรับแต่งได้

## คำถามที่พบบ่อย

### MHTML คืออะไร?
MHTML เป็นรูปแบบไฟล์เก็บถาวรเว็บที่ประกอบด้วย HTML และทรัพยากรที่เกี่ยวข้อง เช่น รูปภาพ ทำให้เหมาะกับการเรนเดอร์และการแชร์กิจกรรมในปฏิทิน

### ฉันสามารถแสดงกิจกรรมที่เกิดขึ้นซ้ำๆ ได้หรือไม่
ใช่! Aspose.Email รองรับการแสดงผลเหตุการณ์ที่เกิดขึ้นซ้ำๆ เพื่อให้แน่ใจว่าสามารถบันทึกรายละเอียดทั้งหมดได้อย่างถูกต้อง

### จำเป็นต้องมีใบอนุญาตหรือไม่?
 ใช่ ต้องมีใบอนุญาตที่ถูกต้อง คุณสามารถร้องขอได้[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) เพื่อการประเมินผล

### ฉันสามารถเพิ่มคุณสมบัติที่กำหนดเองให้กับเอาต์พุตได้หรือไม่
 แน่นอน! คุณสามารถปรับแต่งเทมเพลตสำหรับคุณสมบัติเพิ่มเติมได้โดยใช้`FormatTemplates` ของสะสม.

### ฉันจะแก้ไขปัญหาได้อย่างไร
 เยี่ยมชม[ฟอรั่มสนับสนุน Aspose.Email](https://forum.aspose.com/c/email/12/) เพื่อขอความช่วยเหลือจากผู้เชี่ยวชาญ