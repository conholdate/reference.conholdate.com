---
title: แปลงอีเมล HTML เป็นข้อความธรรมดาใน C#
linktitle: แปลงอีเมล HTML เป็นข้อความธรรมดาใน C#
second_title: API การประมวลผลอีเมล Aspose.Email .NET
description: เรียนรู้วิธีการแปลงเนื้อหาอีเมล HTML เป็นข้อความธรรมดาได้อย่างง่ายดายโดยใช้ Aspose.Email สำหรับ .NET ในบทช่วยสอนทีละขั้นตอนโดยละเอียดนี้
type: docs
weight: 19
url: /th/net/tutorials/email/guide-to-email-processing-and-analysis/convert-html-email-to-plain-text/
---
## การแนะนำ

ในภูมิทัศน์การสื่อสารดิจิทัลในปัจจุบัน อีเมลมักถูกสร้างขึ้นโดยใช้ HTML เพื่อใช้ประโยชน์จากตัวเลือกการจัดรูปแบบที่หลากหลาย อย่างไรก็ตาม มีสถานการณ์ที่คุณอาจต้องแปลงเนื้อหา HTML ของอีเมลเป็นข้อความธรรมดา อาจเพื่อความเข้ากันได้กับระบบเดิม เพื่อลดขนาดไฟล์ หรือเพียงเพื่อให้แน่ใจว่าผู้ใช้ที่มีความต้องการการเข้าถึงบางอย่างสามารถอ่านได้ หากคุณพบว่าตัวเองอยู่ในสถานการณ์เช่นนี้ คุณมาถูกที่แล้ว! ในบทช่วยสอนนี้ เราจะเจาะลึกถึงวิธีการแปลงเนื้อหา HTML เป็นข้อความธรรมดาโดยใช้ Aspose.Email สำหรับ .NET 

เราจะอธิบายขั้นตอนทั้งหมดตั้งแต่ข้อกำหนดเบื้องต้นไปจนถึงการนำไปใช้งาน โดยมีคำแนะนำแบบทีละขั้นตอนที่ชัดเจน พร้อมหรือยัง เริ่มกันเลย!

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึกถึงรายละเอียดของการเขียนโค้ด มีบางสิ่งที่คุณจำเป็นต้องพร้อมเพื่อให้แน่ใจว่าจะได้รับประสบการณ์ที่ราบรื่น:

1. ความเข้าใจพื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับภาษาการเขียนโปรแกรม C# จะเป็นประโยชน์ หากคุณเคยใช้ C# มาก่อน นั่นก็สมบูรณ์แบบ!

2. Aspose.Email สำหรับ .NET: คุณต้องติดตั้ง Aspose.Email ไว้ในโปรเจ็กต์ของคุณ คุณสามารถรับได้ผ่าน[เว็บไซต์อาโพส](https://releases.aspose.com/email/net/).

3. Visual Studio: ตรวจสอบให้แน่ใจว่าคุณได้ตั้งค่า Visual Studio เป็น IDE ของคุณแล้ว เพื่อประสบการณ์การเขียนโค้ดและการดีบักที่ราบรื่น

4.  Aspose.Words สำหรับ .NET (หากยังไม่ได้รวมไว้): เนื่องจากเราจะใช้ Aspose.Words ในการจัดการการแปลง HTML เป็นข้อความธรรมดาด้วย โปรดตรวจสอบให้แน่ใจว่าได้เพิ่มไลบรารีนี้ลงในโปรเจ็กต์ของคุณแล้ว ซึ่งคุณสามารถค้นหาได้เช่นกัน[ที่นี่](https://releases.aspose.com/words/net/).

5.  ไฟล์อีเมล HTML ตัวอย่าง: เตรียมไฟล์ HTML ตัวอย่างเพื่อใช้งาน โดยตั้งชื่อให้เหมาะสม`sample.html`เพื่อโหลดและทดสอบการแปลงได้อย่างง่ายดาย

## แพ็คเกจนำเข้า

ขั้นแรก เราต้องตรวจสอบให้แน่ใจก่อนว่าเนมสเปซที่จำเป็นนั้นพร้อมใช้งาน คุณจะต้องนำเข้าเนมสเปซ Aspose.Email และ Aspose.Words ที่จุดเริ่มต้นของไฟล์ C#:

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Words;
using Aspose.Words.Saving;
```

เนมสเปซเหล่านี้จะทำให้คุณสามารถเข้าถึงคลาสและวิธีการที่จำเป็นจากไลบรารี Aspose ได้

## ขั้นตอนที่ 1: โหลดข้อความอีเมล์

ขั้นตอนแรกในการเดินทางของเราคือการโหลดข้อความอีเมลจากไฟล์ HTML นี่เป็นกระบวนการง่ายๆ ที่จะกำหนดทิศทางสำหรับสิ่งที่จะเกิดขึ้นต่อไป วิธีดำเนินการมีดังนี้:

```csharp
MailMessage message = MailMessage.Load("sample.html");
```

 ที่นี่เราเรียกง่ายๆว่า`MailMessage.Load()` และส่งชื่อไฟล์ของตัวอย่าง HTML ของเรา บรรทัดนี้จะสร้างอ็อบเจ็กต์ที่แสดงถึงอีเมล

## ขั้นตอนที่ 2: แยกเนื้อหา HTML

ขั้นต่อไป เราต้องดึงเนื้อหา HTML ออกจากข้อความอีเมล ลองนึกถึงขั้นตอนนี้ว่าเป็นการดึงส่วนฉ่ำของผลไม้ออกมา—แต่เฉพาะส่วนที่ดีเท่านั้น!

```csharp
string htmlBody = message.HtmlBody;
```

 โดยการเข้าถึง`HtmlBody` ทรัพย์สินของ`MailMessage` วัตถุ เนื้อหา HTML ตอนนี้ถูกเก็บไว้ในตัวแปรสตริงที่มีชื่อว่า`htmlBody`.

## ขั้นตอนที่ 3: เตรียมการแปลง HTML เป็นข้อความธรรมดา

ตอนนี้เรามีเนื้อหา HTML แล้ว ถึงเวลาเตรียมแปลง เราจะใช้ Aspose.Words เพื่อแปลง HTML ที่มีเนื้อหาสมบูรณ์เป็นข้อความธรรมดา แต่ก่อนอื่น เราต้องสร้างเอกสารใหม่:

```csharp
Document doc = new Document();
doc.RemoveAllChildren();
```

 นี่จะสร้างช่องว่างใหม่`Document`เราจะลบโหนดย่อยทั้งหมดที่มีอยู่เพื่อให้แน่ใจว่ามีสถานะสะอาดก่อนที่เราจะเริ่มแทรกเนื้อหา HTML

## ขั้นตอนที่ 4: แทรกเนื้อหา HTML

 นี่คือจุดที่ความมหัศจรรย์ของการเปลี่ยนแปลงเกิดขึ้น! เราจะใช้`DocumentBuilder` คลาสจาก Aspose.Words เพื่อแทรกเนื้อหา HTML ของเราลงในเอกสาร 

```csharp
doc.AppendDocument(new DocumentBuilder().InsertHtml(htmlBody).Document, ImportFormatMode.KeepSourceFormatting);
```

 ที่นี่,`DocumentBuilder().InsertHtml(htmlBody)` นำสตริง HTML ของเราไปโหลดลงในโครงสร้างเอกสารใหม่ภายใน`Document` วัตถุ. การใช้`ImportFormatMode.KeepSourceFormatting` ช่วยให้แน่ใจว่าการจัดรูปแบบยังคงสมบูรณ์ในระหว่างการดำเนินการนี้

## ขั้นตอนที่ 5: บันทึกไฟล์ข้อความธรรมดา

ในที่สุด ก็ถึงเวลาบันทึกไฟล์ข้อความธรรมดาที่เราเพิ่งสร้างขึ้น วิธีการทำมีดังนี้:

```csharp
doc.Save("plain_text.txt", SaveFormat.Text);
```

 เส้นนี้ช่วยประหยัดของเรา`Document` เป็นไฟล์ข้อความธรรมดาที่มีชื่อว่า`plain_text.txt`Voila! ตอนนี้คุณมีอีเมล HTML ต้นฉบับในรูปแบบข้อความธรรมดาที่สะอาดแล้ว!

## บทสรุป

ขอแสดงความยินดี! คุณเพิ่งเรียนรู้วิธีการแปลงเนื้อหา HTML จากอีเมลเป็นข้อความธรรมดาโดยใช้ Aspose.Email สำหรับ .NET กระบวนการนี้ตรงไปตรงมาและมีประโยชน์อย่างยิ่งในสถานการณ์ต่างๆ เช่น การเพิ่มความเข้ากันได้และการรับรองการเข้าถึง 

## คำถามที่พบบ่อย

### C# ในบทช่วยสอนนี้ใช้ทำอะไร?  
C# คือภาษาการเขียนโปรแกรมที่เราใช้ในการดำเนินการตามตรรกะที่จำเป็นสำหรับการแปลง HTML เป็นข้อความธรรมดา

### ฉันต้องมีใบอนุญาตเพื่อใช้ผลิตภัณฑ์ Aspose หรือไม่?  
 ใช่ แม้ว่า Aspose จะให้ทดลองใช้งานฟรี แต่คุณจะต้องมีใบอนุญาตที่ถูกต้องจึงจะใช้งานแบบขยายเวลาได้ คุณสามารถขอใบอนุญาตชั่วคราวได้[ที่นี่](https://purchase.conholdate.com/temporary-license/).

### ฉันสามารถใช้ Aspose.Email โดยไม่ใช้ Aspose.Words สำหรับการแปลงนี้ได้หรือไม่  
ในปัจจุบัน สำหรับการแปลงเนื้อหา HTML เป็นข้อความธรรมดา จำเป็นต้องใช้ Aspose.Words เพื่อจัดการการจัดรูปแบบ HTML อย่างมีประสิทธิภาพ

### ฉันสามารถหาตัวอย่างเพิ่มเติมเกี่ยวกับการใช้ Aspose.Email ได้ที่ไหน  
 คุณสามารถสำรวจตัวอย่างเพิ่มเติมและเอกสารรายละเอียดได้ที่[หน้าเอกสารอีเมล Aspose](https://reference.aspose.com/email/net/).

### จะเกิดอะไรขึ้นหากฉันประสบปัญหาในระหว่างการใช้งาน?  
 หากต้องการแก้ไขปัญหาและการสนับสนุน คุณสามารถไปที่ฟอรัมสนับสนุน Aspose[ที่นี่](https://forum.aspose.com/c/email/12/).