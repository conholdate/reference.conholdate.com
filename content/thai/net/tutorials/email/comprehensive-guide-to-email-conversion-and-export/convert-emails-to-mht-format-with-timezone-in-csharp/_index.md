---
title: แปลงอีเมลเป็นรูปแบบ MHT ด้วยโซนเวลาใน C#
linktitle: แปลงอีเมลเป็นรูปแบบ MHT ด้วยโซนเวลาใน C#
second_title: API การประมวลผลอีเมล Aspose.Email .NET
description: คู่มือโดยละเอียดนี้ให้คำแนะนำที่ชัดเจนเกี่ยวกับวิธีการแปลงข้อความอีเมลเป็นรูปแบบ MHT พร้อมกับจัดการข้อมูลโซนเวลาอย่างแม่นยำโดยใช้ไลบรารี Aspose.Email สำหรับ .NET
type: docs
weight: 12
url: /th/net/tutorials/email/comprehensive-guide-to-email-conversion-and-export/convert-emails-to-mht-format-with-timezone-in-csharp/
---
## การแนะนำ

การแปลงข้อความอีเมลเป็นรูปแบบต่างๆ เป็นงานทั่วไปในแอปพลิเคชันซอฟต์แวร์ โดยเฉพาะในสถานการณ์ที่ข้อมูลเวลาและเขตเวลามีความสำคัญ คู่มือนี้จะแนะนำคุณเกี่ยวกับกระบวนการแปลงอีเมลเป็นรูปแบบ MHT พร้อมทั้งรับประกันว่าข้อมูลเขตเวลาได้รับการเก็บรักษาไว้อย่างถูกต้อง

## การตั้งค่าสภาพแวดล้อมการพัฒนาของคุณ

ในการเริ่มต้น ให้แน่ใจว่าคุณมีสภาพแวดล้อมการพัฒนาที่เหมาะสม:

1. ติดตั้ง Visual Studio: ตรวจสอบให้แน่ใจว่าคุณมี Visual Studio เวอร์ชันที่เข้ากันได้ติดตั้งอยู่บนเครื่องของคุณ
2. สร้างโครงการ C# ใหม่: เปิด Visual Studio และสร้างโครงการ C# ใหม่สำหรับแอปพลิเคชันการแปลงอีเมลของคุณ

## การติดตั้ง Aspose.Email สำหรับ .NET

Aspose.Email สำหรับ .NET เป็นไลบรารีอันทรงพลังที่ช่วยลดความซับซ้อนของงานประมวลผลอีเมล ทำตามขั้นตอนเหล่านี้เพื่อติดตั้ง:

1. เปิดโปรเจ็กต์ของคุณใน Visual Studio
2. ไปที่เครื่องมือ > ตัวจัดการแพ็กเกจ NuGet > จัดการแพ็กเกจ NuGet สำหรับโซลูชัน
3. ค้นหา Aspose.Email และติดตั้งแพ็กเกจ
```csharp
// เพิ่มคำสั่งที่จำเป็นในการใช้งาน
using Aspose.Email;
```
## การโหลดและการแยกวิเคราะห์ข้อความอีเมล์

ขั้นต่อไป คุณจะต้องโหลดและแยกข้อความอีเมลที่คุณต้องการแปลง ใช้โค้ดสั้นๆ ดังต่อไปนี้:

```csharp
// โหลดข้อความอีเมล์
var message = MailMessage.Load("path/to/your/email.eml");

// การเข้าถึงคุณสมบัติของข้อความ
var subject = message.Subject;
var sender = message.From.Address;
// ...คุณสมบัติอื่น ๆ ตามความจำเป็น
```

## การจัดการข้อมูลโซนเวลา

การจัดการข้อมูลโซนเวลาอย่างแม่นยำถือเป็นสิ่งสำคัญ โค้ดตัวอย่างต่อไปนี้จะสาธิตวิธีดึงและจัดการข้อมูลโซนเวลาจากข้อความอีเมล:

```csharp
var timezone = message.TimezoneOffset;
var timezoneId = Timezone.GetIdFromOffset(timezone);
var timezoneInfo = TimeZoneInfo.FindSystemTimeZoneById(timezoneId);
// ตอนนี้คุณสามารถใช้ timezoneInfo เพื่อจัดการการแปลงเขตเวลาได้แล้ว
```

## การแปลงอีเมลเป็นรูปแบบ MHT

ตอนนี้เรามาทำการแปลงแกนเป็นรูปแบบ MHT โดยใช้ Aspose กัน อีเมล:

```csharp
// ตั้งค่าตัวเลือกการบันทึก MHT
var mhtOptions = MhtSaveOptions.DefaultMhtml;

// สร้างสตรีมหน่วยความจำสำหรับเอาท์พุต MHT
using var mhtStream = new MemoryStream();
message.Save(mhtStream, mhtOptions);
```

## การบันทึกไฟล์ MHT

เมื่อข้อความอีเมลถูกแปลงเป็นรูปแบบ MHT แล้ว ถึงเวลาที่จะบันทึกเป็นไฟล์:

```csharp
// บันทึกสตรีม MHT ลงในไฟล์
using var fileStream = new FileStream("output.mht", FileMode.Create);
mhtStream.Seek(0, SeekOrigin.Begin);
mhtStream.CopyTo(fileStream);
```

## บทสรุป

ในคู่มือนี้ คุณจะได้เรียนรู้วิธีการแปลงข้อความอีเมลเป็นรูปแบบ MHT พร้อมทั้งจัดการข้อมูลโซนเวลาอย่างมีประสิทธิภาพโดยใช้ Aspose.Email สำหรับ .NET โดยทำตามขั้นตอนเหล่านี้และสำรวจตัวเลือกการปรับแต่งเพิ่มเติม คุณสามารถผสานฟังก์ชันการแปลงอีเมลเข้ากับแอปพลิเคชันของคุณได้อย่างราบรื่น

## คำถามที่พบบ่อย

### ฉันจะจัดการไฟล์แนบในระหว่างการแปลงอีเมลได้อย่างไร

 ในการจัดการสิ่งที่แนบมา ให้ใช้`Attachments` ทรัพย์สินของ`MailMessage` คลาส ทำซ้ำผ่านสิ่งที่แนบมาและบันทึกไว้ตามต้องการในระหว่างกระบวนการแปลง

### ฉันสามารถแปลงอีเมลเป็นรูปแบบอื่นโดยใช้ Aspose.Email สำหรับ .NET ได้หรือไม่

แน่นอน! Aspose.Email สำหรับ .NET รองรับรูปแบบต่างๆ เช่น MSG, EML, PST และอื่นๆ คุณสามารถปรับแต่งตัวอย่างโค้ดที่ให้มาเพื่อให้เหมาะกับรูปแบบผลลัพธ์ที่คุณต้องการได้

### ข้อมูลโซนเวลาจะถูกเก็บรักษาในรูปแบบ MHT หรือไม่?

 ใช่ ข้อมูลโซนเวลาจะถูกเก็บรักษาไว้ระหว่างกระบวนการแปลง โดยการจัดการการชดเชยโซนเวลาและใช้ข้อมูลที่เหมาะสม`TimeZoneInfo`วิธีการนี้ช่วยให้คุณสามารถมั่นใจได้ถึงการแสดงโซนเวลาที่ถูกต้องในไฟล์ MHT

### ฉันสามารถหาเอกสารเพิ่มเติมและอัพเดตเกี่ยวกับ Aspose.Email สำหรับ .NET ได้จากที่ใด

 สำหรับข้อมูลครบถ้วนและการอัปเดต โปรดดูเอกสารประกอบ:[เอกสารอ้างอิง API ของ Aspose.Email สำหรับ .NET](https://reference.aspose.com/email/net/)

### ฉันจะดาวน์โหลด Aspose.Email สำหรับ .NET เวอร์ชันล่าสุดได้อย่างไร

 คุณสามารถดาวน์โหลดเวอร์ชันล่าสุดได้จากหน้าเผยแพร่:[ดาวน์โหลด Aspose.Email สำหรับ .NET](https://releases.aspose.com/email/net/)