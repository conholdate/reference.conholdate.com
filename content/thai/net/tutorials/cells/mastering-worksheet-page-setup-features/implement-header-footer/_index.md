---
title: การนำส่วนหัวและส่วนท้ายไปใช้งานกับ Aspose.Cells สำหรับ .NET
linktitle: การนำส่วนหัวและส่วนท้ายไปใช้งานกับ Aspose.Cells สำหรับ .NET
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: ค้นพบวิธีการยกระดับเอกสาร Excel ของคุณด้วยการปรับแต่งส่วนหัวและส่วนท้ายด้วยโปรแกรมโดยใช้ Aspose.Cells สำหรับ .NET คู่มือที่ครอบคลุมนี้จะแนะนำคุณในแต่ละขั้นตอน ตั้งแต่การตั้งค่าเวิร์กบุ๊กไปจนถึงการแทรกชื่อเวิร์กชีตแบบไดนามิก
type: docs
weight: 22
url: /th/net/tutorials/cells/mastering-worksheet-page-setup-features/implement-header-footer/
---
## การแนะนำ

ส่วนหัวและส่วนท้ายเป็นองค์ประกอบสำคัญในสเปรดชีต Excel ซึ่งให้ข้อมูลบริบทที่สำคัญ เช่น ชื่อไฟล์ วันที่ และหมายเลขหน้า ไม่ว่าคุณจะกำลังสร้างรายงานอัตโนมัติหรือสร้างไฟล์แบบไดนามิก Aspose.Cells สำหรับ .NET จะทำให้กระบวนการปรับแต่งส่วนหัวและส่วนท้ายในโปรแกรมเป็นเรื่องง่ายขึ้น คู่มือนี้นำเสนอแนวทางทีละขั้นตอนเพื่อปรับปรุงไฟล์ Excel ของคุณด้วยส่วนหัวและส่วนท้ายที่สวยงามและเป็นมืออาชีพ

## ข้อกำหนดเบื้องต้น

ก่อนที่จะดำน้ำ ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1.  Aspose.Cells สำหรับ .NET: ดาวน์โหลดและติดตั้งจาก[ที่นี่](https://releases.aspose.com/cells/net/).
2. การตั้งค่า IDE: ใช้ Visual Studio หรือ IDE ที่คุณต้องการกับ .NET framework
3.  ใบอนุญาต: เริ่มต้นด้วยการทดลองใช้ฟรี แต่ควรพิจารณาซื้อใบอนุญาตแบบเต็มหรือชั่วคราวเพื่อให้ใช้งานได้ครบถ้วน คุณสามารถ[รับใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/).

## การนำเข้าแพ็คเกจที่จำเป็น

เริ่มต้นด้วยการนำเข้าเนมสเปซที่จำเป็นในโครงการของคุณ:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

ซึ่งจะทำให้คุณสามารถเข้าถึงคลาสและวิธีการที่จำเป็นสำหรับการทำงานกับส่วนหัว ส่วนท้าย และฟังก์ชัน Excel อื่น ๆ ใน Aspose.Cells ได้

## ขั้นตอนที่ 1: สร้างเวิร์กบุ๊กและเข้าถึงการตั้งค่าหน้า

เริ่มต้นด้วยการสร้างเวิร์กบุ๊กใหม่และเข้าถึงการตั้งค่าหน้าของเวิร์กชีต นี่คือที่ที่คุณจะแก้ไขการตั้งค่าส่วนหัวและส่วนท้าย

```csharp
// กำหนดเส้นทางที่จะบันทึกเอกสารของคุณ
string dataDir = "Your Document Directory";

// สร้างอินสแตนซ์ของวัตถุเวิร์กบุ๊ก
Workbook excel = new Workbook();
```

 ที่นี่`Workbook` วัตถุแสดงถึงไฟล์ Excel ของคุณ`PageSetup` คุณสมบัติของเวิร์กชีตจะช่วยให้คุณปรับแต่งส่วนหัวและส่วนท้ายได้

## ขั้นตอนที่ 2: เข้าถึงคุณสมบัติเวิร์กชีตและการตั้งค่าหน้า

 แต่ละเวิร์กชีตใน Aspose.Cells มี`PageSetup` คุณสมบัติที่ควบคุมคุณลักษณะเค้าโครง รวมถึงส่วนหัวและส่วนท้าย รับ`PageSetup` วัตถุสำหรับแผ่นงานของคุณ:

```csharp
// รับการอ้างอิงถึง PageSetup ของเวิร์กชีตแรก
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
```

 ตอนนี้,`pageSetup` ประกอบด้วยการตั้งค่าที่จำเป็นเพื่อปรับแต่งส่วนหัวและส่วนท้าย

## ขั้นตอนที่ 3: ตั้งค่าส่วนซ้ายของส่วนหัว

ส่วนหัวประกอบด้วยสามส่วน ได้แก่ ด้านซ้าย ส่วนกลาง และด้านขวา เริ่มต้นด้วยการกำหนดส่วนด้านซ้ายให้แสดงชื่อเวิร์กชีต

```csharp
// ตั้งชื่อเวิร์กชีตในส่วนด้านซ้ายของส่วนหัว
pageSetup.SetHeader(0, "&A");
```

 โดยใช้`&A`แสดงชื่อเวิร์กชีตแบบไดนามิก ซึ่งมีประโยชน์อย่างยิ่งสำหรับเวิร์กบุ๊กหลายแผ่นงาน

## ขั้นตอนที่ 4: เพิ่มวันที่และเวลาลงตรงกลางส่วนหัว

ขั้นตอนต่อไป เพิ่มวันที่และเวลาปัจจุบันลงในส่วนตรงกลางของส่วนหัว โดยใช้แบบอักษรที่กำหนดเองเพื่อการจัดรูปแบบ

```csharp
// ตั้งค่าวันที่และเวลาในส่วนตรงกลางของส่วนหัวด้วยแบบอักษรตัวหนา
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
```

ในบรรทัดนี้:
- `&D` แทรกวันที่ปัจจุบัน
- `&T` แทรกเวลาปัจจุบัน
- `"Times New Roman,Bold"` ใช้แบบอักษร Times New Roman แบบตัวหนา

## ขั้นตอนที่ 5: แสดงชื่อไฟล์ในส่วนด้านขวาของส่วนหัว

เพื่อทำให้ส่วนหัวเสร็จสมบูรณ์ ให้แสดงชื่อไฟล์ทางด้านขวาพร้อมขนาดฟอนต์ที่ระบุ

```csharp
// แสดงชื่อไฟล์ในส่วนด้านขวาของส่วนหัวด้วยขนาดตัวอักษรที่กำหนดเอง
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
```

 ที่นี่,`&F` แสดงชื่อไฟล์และ`&12` กำหนดขนาดตัวอักษรเป็น 12

## ขั้นตอนที่ 6: เพิ่มข้อความที่กำหนดเองในส่วนท้ายด้านซ้าย

ต่อไปเรามาตั้งค่าส่วนท้ายซ้ายด้วยข้อความแบบกำหนดเองและรูปแบบอักษรที่เฉพาะเจาะจง

```csharp
// เพิ่มข้อความแบบกำหนดเองพร้อมรูปแบบแบบอักษรที่ส่วนซ้ายของส่วนท้าย
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
```

ในตัวอย่างนี้ข้อความ`123` ได้รับการออกแบบด้วยแบบอักษร "Courier New" ขนาด 14 ในขณะที่ส่วนที่เหลือยังคงเป็นแบบอักษรส่วนท้ายแบบเริ่มต้น

## ขั้นตอนที่ 7: แทรกหมายเลขหน้าไว้ตรงกลางส่วนท้าย

การใส่หมายเลขหน้าไว้ในส่วนท้ายช่วยให้ผู้อ่านติดตามเอกสารหลายหน้าได้

```csharp
// แทรกหมายเลขหน้าในส่วนตรงกลางของส่วนท้าย
pageSetup.SetFooter(1, "&P");
```

 การ`&P` โค้ดจะเพิ่มหมายเลขหน้าปัจจุบันลงในส่วนตรงกลางของส่วนท้าย

## ขั้นตอนที่ 8: แสดงจำนวนหน้าทั้งหมดในส่วนท้ายด้านขวา

กรอกข้อมูลส่วนท้ายให้เสร็จสมบูรณ์โดยแสดงจำนวนหน้าทั้งหมดในส่วนด้านขวา

```csharp
// แสดงจำนวนหน้าทั้งหมดในส่วนขวาของส่วนท้าย
pageSetup.SetFooter(2, "&N");
```

 การ`&N` รหัสนี้จะแจ้งจำนวนหน้าทั้งหมด เพื่อแจ้งให้ผู้อ่านทราบถึงความยาวของเอกสาร

## ขั้นตอนที่ 9: บันทึกสมุดงาน

สุดท้าย ให้บันทึกเวิร์กบุ๊กเพื่อสร้างไฟล์ Excel ที่มีส่วนหัวและส่วนท้ายที่กำหนดเอง

```csharp
// บันทึกสมุดงาน
excel.Save(dataDir + "SetHeadersAndFooters_out.xls");
```

บรรทัดนี้จะบันทึกไฟล์ที่มีการปรับแต่งของคุณอยู่

## บทสรุป

การปรับแต่งส่วนหัวและส่วนท้ายในเวิร์กชีต Excel จะช่วยเพิ่มความเป็นมืออาชีพให้กับเอกสารของคุณ ด้วย Aspose.Cells สำหรับ .NET คุณสามารถควบคุมองค์ประกอบเหล่านี้ได้อย่างง่ายดาย ตั้งแต่การแสดงชื่อเวิร์กชีตไปจนถึงการแทรกข้อความที่กำหนดเอง วันที่ เวลา และหมายเลขหน้าแบบไดนามิก ตอนนี้คุณได้เรียนรู้ขั้นตอนเหล่านี้แล้ว คุณสามารถยกระดับโครงการอัตโนมัติของ Excel ของคุณได้

## คำถามที่พบบ่อย

### ฉันสามารถใช้แบบอักษรที่แตกต่างกันสำหรับส่วนหัวและส่วนท้ายต่างๆ ได้หรือไม่
ใช่ Aspose.Cells อนุญาตให้คุณระบุแบบอักษรที่ไม่ซ้ำกันสำหรับแต่ละส่วนของส่วนหัวและส่วนท้ายได้

### ฉันจะลบส่วนหัวและส่วนท้ายได้อย่างไร
 ล้างส่วนหัวและส่วนท้ายโดยตั้งค่าข้อความเป็นสตริงว่างโดยใช้`SetHeader` หรือ`SetFooter`.

### ฉันสามารถแทรกภาพลงในส่วนหัวหรือส่วนท้ายด้วย Aspose.Cells สำหรับ .NET ได้หรือไม่
ปัจจุบัน Aspose.Cells รองรับข้อความในส่วนหัวและส่วนท้ายเป็นหลัก รูปภาพอาจต้องใช้วิธีการอื่น เช่น การแทรกลงในเวิร์กชีตโดยตรง

### Aspose.Cells รองรับข้อมูลแบบไดนามิกในส่วนหัวและส่วนท้ายหรือไม่  
 ใช่ คุณสามารถใช้โค้ดไดนามิกต่างๆ ได้ (เช่น`&D`สำหรับวันที่หรือ`&P` สำหรับหมายเลขหน้า) เพื่อเพิ่มเนื้อหาแบบไดนามิก

### ฉันจะปรับความสูงของส่วนหัวและส่วนท้ายได้อย่างไร  
 Aspose.Cells มีตัวเลือกภายใน`PageSetup` คลาสที่จะปรับระยะขอบส่วนหัวและส่วนท้าย ทำให้คุณสามารถควบคุมระยะห่างได้