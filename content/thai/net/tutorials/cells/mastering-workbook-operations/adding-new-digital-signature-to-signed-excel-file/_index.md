---
title: การเพิ่มลายเซ็นดิจิทัลใหม่ลงในไฟล์ Excel ที่ลงนามแล้ว
linktitle: การเพิ่มลายเซ็นดิจิทัลใหม่ลงในไฟล์ Excel ที่ลงนามแล้ว
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการเพิ่มลายเซ็นดิจิทัลใหม่ลงในไฟล์ Excel ที่มีลายเซ็นอยู่แล้วโดยใช้ Aspose.Cells สำหรับ .NET คู่มือฉบับสมบูรณ์นี้ครอบคลุมข้อกำหนดเบื้องต้น คำแนะนำทีละขั้นตอน และตัวอย่างโค้ดทั้งหมด
type: docs
weight: 12
url: /th/net/tutorials/cells/mastering-workbook-operations/adding-new-digital-signature-to-signed-excel-file/
---
## การแนะนำ

ในภูมิทัศน์ดิจิทัลของปัจจุบัน การรับรองความถูกต้องและความสมบูรณ์ของเอกสารมีความสำคัญมากกว่าที่เคย ลายเซ็นดิจิทัลเป็นวิธีที่เชื่อถือได้ในการตรวจสอบว่าเอกสารไม่ได้ถูกเปลี่ยนแปลงและมาจากแหล่งที่ถูกต้อง หากคุณกำลังทำงานกับไฟล์ Excel ใน .NET และจำเป็นต้องเพิ่มลายเซ็นดิจิทัลใหม่ลงในไฟล์ที่ลงนามแล้ว คู่มือนี้เหมาะสำหรับคุณ เราจะแนะนำขั้นตอนการเพิ่มลายเซ็นดิจิทัลลงในไฟล์ Excel ที่ลงนามแล้วโดยใช้ Aspose.Cells สำหรับ .NET

## ข้อกำหนดเบื้องต้น

ก่อนที่จะลงลึกถึงการใช้งานจริง ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1.  Aspose.Cells สำหรับ .NET: ดาวน์โหลดและติดตั้ง Aspose.Cells จาก[หน้าวางจำหน่าย](https://releases.aspose.com/cells/net/).
2. .NET Framework: ตรวจสอบให้แน่ใจว่าเครื่องของคุณได้ติดตั้ง .NET Framework แล้ว และคุณคุ้นเคยกับแนวคิดการเขียนโปรแกรม .NET ขั้นพื้นฐาน
3. ใบรับรองดิจิทัล: รับใบรับรองดิจิทัลที่ถูกต้องในรูปแบบ .pfx สำหรับการทดสอบ คุณสามารถสร้างใบรับรองที่ลงนามด้วยตนเองได้
4. สภาพแวดล้อมการพัฒนา: ใช้ IDE เช่น Visual Studio เพื่อเขียนและดำเนินการโค้ด C# ของคุณ
5. ตัวอย่างไฟล์ Excel: มีไฟล์ Excel ที่มีอยู่แล้วซึ่งลงนามดิจิทัลแล้ว ซึ่งจะเป็นเป้าหมายสำหรับการเพิ่มลายเซ็นใหม่

เมื่อมีข้อกำหนดเบื้องต้นเหล่านี้แล้ว มาเริ่มเขียนโค้ดกันเลย!

## แพ็คเกจนำเข้าที่จำเป็น

ที่ด้านบนสุดของไฟล์ C# ของคุณ ให้รวมเนมสเปซต่อไปนี้เพื่อเข้าถึงคลาสและวิธีการที่จำเป็น:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

## ขั้นตอนที่ 1: กำหนดไดเรกทอรีของคุณ

ระบุไดเร็กทอรีสำหรับไฟล์ต้นฉบับของคุณและตำแหน่งที่จะบันทึกไฟล์เอาท์พุต:

```csharp
// ไดเรกทอรีแหล่งที่มา
string sourceDir = "Your Document Directory"; // แทนที่ด้วยไดเร็กทอรีจริงของคุณ
// ไดเรกทอรีผลลัพธ์
string outputDir = "Your Document Directory"; // แทนที่ด้วยไดเร็กทอรีจริงของคุณ
```

## ขั้นตอนที่ 2: โหลดสมุดงานที่ลงนามที่มีอยู่

โหลดสมุดงาน Excel ที่ถูกเซ็นชื่อแล้ว:

```csharp
// โหลดสมุดงานที่มีลายเซ็นดิจิทัลแล้ว
Aspose.Cells.Workbook workbook = new Aspose.Cells.Workbook(sourceDir + "sampleDigitallySignedByCells.xlsx");
```

## ขั้นตอนที่ 3: สร้างคอลเลกชันลายเซ็นดิจิทัล

สร้างคอลเลกชันเพื่อจัดการลายเซ็นดิจิทัลของคุณ:

```csharp
//สร้างคอลเลกชันลายเซ็นดิจิทัล
Aspose.Cells.DigitalSignatures.DigitalSignatureCollection dsCollection = new Aspose.Cells.DigitalSignatures.DigitalSignatureCollection();
```

## ขั้นตอนที่ 4: โหลดใบรับรองของคุณ

โหลดใบรับรองดิจิทัลของคุณซึ่งจะใช้เพื่อสร้างลายเซ็นใหม่:

```csharp
// ไฟล์ใบรับรองและรหัสผ่าน
string certFileName = sourceDir + "AsposeDemo.pfx"; // ไฟล์ใบรับรองของคุณ
string password = "aspose"; // รหัสผ่านใบรับรองของคุณ

// สร้างใบรับรองใหม่
System.Security.Cryptography.X509Certificates.X509Certificate2 certificate = new System.Security.Cryptography.X509Certificates.X509Certificate2(certFileName, password);
```

## ขั้นตอนที่ 5: สร้างลายเซ็นดิจิทัลใหม่

ตอนนี้ให้สร้างลายเซ็นดิจิทัลใหม่และเพิ่มลงในคอลเลกชั่นของคุณ:

```csharp
// สร้างลายเซ็นดิจิทัลใหม่และเพิ่มลงในคอลเลกชัน
Aspose.Cells.DigitalSignatures.DigitalSignature signature = new Aspose.Cells.DigitalSignatures.DigitalSignature(certificate, "Aspose.Cells added new digital signature in existing digitally signed workbook.", DateTime.Now);
dsCollection.Add(signature);
```

## ขั้นตอนที่ 6: เพิ่มคอลเลกชันลายเซ็นลงในเวิร์กบุ๊ก

เพิ่มคอลเลกชันลายเซ็นดิจิทัลลงในสมุดงาน:

```csharp
// เพิ่มคอลเลกชันลายเซ็นดิจิทัลลงในสมุดงาน
workbook.AddDigitalSignature(dsCollection);
```

## ขั้นตอนที่ 7: บันทึกสมุดงาน

บันทึกสมุดงานโดยมีลายเซ็นดิจิทัลใหม่รวมอยู่ด้วย:

```csharp
// บันทึกสมุดงาน
workbook.Save(outputDir + "outputDigitallySignedByCells.xlsx");
workbook.Dispose();
```

## ขั้นตอนที่ 8: ยืนยันความสำเร็จ

ให้ข้อเสนอแนะเมื่อดำเนินการสำเร็จ:

```csharp
Console.WriteLine("Successfully added a digital signature to the existing signed Excel file.");
```

## บทสรุป

ขอแสดงความยินดี! คุณได้เพิ่มลายเซ็นดิจิทัลใหม่ลงในไฟล์ Excel ที่ลงนามแล้วโดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว กระบวนการนี้ช่วยเพิ่มความปลอดภัยให้กับเอกสารของคุณและรับรองความถูกต้องและความสมบูรณ์ของเอกสาร

## คำถามที่พบบ่อย

### ลายเซ็นดิจิทัลคืออะไร?

ลายเซ็นดิจิทัลเป็นระบบคณิตศาสตร์ที่ตรวจสอบความถูกต้องและความสมบูรณ์ของข้อความหรือเอกสารดิจิทัล โดยรับรองว่าจะไม่มีการแก้ไข และยืนยันตัวตนของผู้ลงนาม

### ฉันต้องมีใบรับรองพิเศษเพื่อสร้างลายเซ็นดิจิทัลหรือไม่

ใช่ ต้องมีใบรับรองดิจิทัลที่ออกโดยผู้ให้บริการใบรับรอง (CA) ที่เชื่อถือได้เพื่อสร้างลายเซ็นดิจิทัลที่ถูกต้อง

### ฉันสามารถใช้ใบรับรองที่ลงนามเองเพื่อทำการทดสอบได้หรือไม่

แน่นอน! คุณสามารถใช้ใบรับรองที่ลงนามเองเพื่อวัตถุประสงค์ในการพัฒนาและการทดสอบ แต่สำหรับการผลิต ขอแนะนำให้ใช้ใบรับรองจาก CA ที่เชื่อถือได้

### จะเกิดอะไรขึ้นหากฉันพยายามเพิ่มลายเซ็นลงบนเอกสารที่ไม่ได้ลงนาม?

หากคุณพยายามที่จะเพิ่มลายเซ็นดิจิทัลลงในเอกสารที่ยังไม่ได้ลงนาม ระบบจะทำงานโดยไม่มีปัญหา แต่ลายเซ็นเดิมจะไม่มีอยู่

### ฉันสามารถหาข้อมูลเพิ่มเติมเกี่ยวกับ Aspose.Cells ได้จากที่ไหน

 สำหรับคำแนะนำโดยละเอียดและการอ้างอิง API โปรดตรวจสอบ[เอกสารประกอบ Aspose.Cells](https://reference.aspose.com/cells/net/).