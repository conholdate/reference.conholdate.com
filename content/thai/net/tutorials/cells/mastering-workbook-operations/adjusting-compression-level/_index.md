---
title: การปรับระดับการบีบอัดในเวิร์กบุ๊ก
linktitle: การปรับระดับการบีบอัดในเวิร์กบุ๊ก
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: ค้นพบวิธีการจัดการไฟล์ Excel ขนาดใหญ่ได้อย่างมีประสิทธิภาพโดยปรับระดับการบีบอัดโดยใช้ Aspose.Cells สำหรับ .NET คำแนะนำทีละขั้นตอนนี้ครอบคลุมทุกอย่างตั้งแต่การตั้งค่าไดเร็กทอรีไปจนถึงการวัดเวลาการบีบอัด ช่วยให้คุณปรับขนาดไฟล์ให้เหมาะสมและเพิ่มประสิทธิภาพการทำงาน
type: docs
weight: 14
url: /th/net/tutorials/cells/mastering-workbook-operations/adjusting-compression-level/
---
## การแนะนำ

การจัดการไฟล์ Excel ขนาดใหญ่ถือเป็นเรื่องท้าทาย โดยเฉพาะอย่างยิ่งเมื่อต้องจัดเก็บและถ่ายโอนข้อมูลอย่างมีประสิทธิภาพ โชคดีที่การบีบอัดไฟล์สามารถลดขนาดไฟล์เหล่านี้ได้อย่างมาก ทำให้จัดการได้ง่ายขึ้น หากคุณใช้ Aspose.Cells สำหรับ .NET คุณสามารถปรับระดับการบีบอัดของเวิร์กบุ๊กได้อย่างง่ายดาย คู่มือนี้จะแนะนำคุณทีละขั้นตอนเกี่ยวกับขั้นตอนต่างๆ ของโค้ด พร้อมทั้งอธิบายแต่ละส่วนอย่างชัดเจน

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด ให้แน่ใจว่าคุณมีข้อกำหนดเบื้องต้นดังต่อไปนี้:

1. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณเข้าใจชิ้นส่วนโค้ดได้ดีขึ้น
2.  ไลบรารี Aspose.Cells: ดาวน์โหลดและติดตั้งไลบรารี Aspose.Cells จาก[ที่นี่](https://releases.aspose.com/cells/net/).
3. Visual Studio: สภาพแวดล้อมการพัฒนาเช่น Visual Studio จำเป็นสำหรับการรันโค้ด
4. .NET Framework: ตรวจสอบให้แน่ใจว่าโครงการของคุณได้รับการตั้งค่าด้วย .NET Framework เวอร์ชันที่เข้ากันได้

## การนำเข้าแพ็คเกจที่จำเป็น

ในการเริ่มต้น คุณต้องนำเข้าแพ็คเกจที่จำเป็นลงในโปรเจ็กต์ C# ของคุณ เพิ่มบรรทัดต่อไปนี้ที่ด้านบนของไฟล์โค้ดของคุณ:

```csharp
using Aspose.Cells.Rendering;
using Aspose.Cells.WebExtensions;
using System;
```

 แพ็คเกจเหล่านี้มีความจำเป็นสำหรับการทำงานกับไฟล์ Excel โดยใช้ไลบรารี Aspose.Cells`Aspose.Cells` เนมสเปซประกอบด้วยคลาสทั้งหมดที่จำเป็นในการจัดการไฟล์ Excel ในขณะที่`Aspose.Cells.Xlsb` ให้ตัวเลือกสำหรับการบันทึกไฟล์ในรูปแบบ XLSB

## ขั้นตอนที่ 1: กำหนดไดเรกทอรีแหล่งที่มาและเอาต์พุต

ขั้นแรก ให้ตั้งค่าไดเร็กทอรีที่ไฟล์ต้นฉบับของคุณตั้งอยู่และตำแหน่งที่คุณต้องการบันทึกไฟล์เอาต์พุต:

```csharp
// กำหนดไดเรกทอรีแหล่งที่มาและเอาต์พุต
string sourceDir = "Your Document Directory\\";
string outDir = "Your Document Directory\\";
```

 อย่าลืมเปลี่ยน`"Your Document Directory\\"` ด้วยเส้นทางจริงไปยังไดเร็กทอรีของคุณ วิธีนี้จะช่วยให้โปรแกรมของคุณสามารถค้นหาไฟล์ที่ต้องการใช้งานได้

## ขั้นตอนที่ 2: โหลดเวิร์กบุ๊ก

ถัดไปโหลดเวิร์กบุ๊กที่คุณต้องการบีบอัด:

```csharp
Workbook workbook = new Workbook(sourceDir + "LargeSampleFile.xlsx");
```

 ที่นี่เราสร้างอินสแตนซ์ใหม่ของ`Workbook` สร้างคลาสและโหลดไฟล์ Excel ที่มีอยู่ ตรวจสอบให้แน่ใจว่าชื่อไฟล์ตรงกับชื่อที่อยู่ในไดเร็กทอรีต้นทางของคุณ

## ขั้นตอนที่ 3: ตั้งค่าตัวเลือกการบันทึก

ตอนนี้กำหนดค่าตัวเลือกการบันทึกสำหรับสมุดงานของคุณ:

```csharp
XlsbSaveOptions options = new XlsbSaveOptions();
```

 การ`XlsbSaveOptions`คลาสช่วยให้คุณสามารถระบุตัวเลือกต่าง ๆ ได้เมื่อบันทึกเวิร์กบุ๊กของคุณในรูปแบบ XLSB รวมถึงระดับการบีบอัด

## ขั้นตอนที่ 4: วัดเวลาการบีบอัดสำหรับระดับ 1

เริ่มต้นด้วยระดับการบีบอัดแรกและวัดเวลาที่ใช้ในการบันทึกเวิร์กบุ๊ก:

```csharp
options.CompressionType = OoxmlCompressionType.Level1;
var watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_1_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 1 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

สไนปเป็ตนี้จะตั้งค่าประเภทการบีบอัดเป็นระดับ 1 บันทึกเวิร์กบุ๊ก และวัดเวลาที่ผ่านไป

## ขั้นตอนที่ 5: วัดเวลาการบีบอัดสำหรับระดับ 6

ถัดไป ทดสอบประสิทธิภาพด้วยการบีบอัดระดับ 6:

```csharp
options.CompressionType = OoxmlCompressionType.Level6;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_6_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 6 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

ขั้นตอนนี้คล้ายกับขั้นตอนก่อนหน้า แต่มีระดับการบีบอัดที่สูงกว่า

## ขั้นตอนที่ 6: วัดเวลาการบีบอัดสำหรับระดับ 9

สุดท้าย ให้ประเมินประสิทธิภาพด้วยระดับการบีบอัดที่สูงที่สุด:

```csharp
options.CompressionType = OoxmlCompressionType.Level9;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_9_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 9 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

ขั้นตอนนี้จะตั้งระดับการบีบอัดไว้ที่ระดับ 9 ซึ่งคุณจะเห็นขนาดไฟล์ลดลงอย่างเห็นได้ชัด แม้ว่าอาจใช้เวลาในการประมวลผลนานกว่าก็ตาม

## ขั้นตอนที่ 7: ผลลัพธ์ขั้นสุดท้าย

หลังจากเสร็จสิ้นระดับการบีบอัดทั้งหมดแล้ว ให้ส่งข้อความแจ้งว่ากระบวนการเสร็จสมบูรณ์:

```csharp
Console.WriteLine("Compression adjustment completed successfully.");
```

บรรทัดง่ายๆ นี้ยืนยันว่าโปรแกรมของคุณทำงานได้โดยไม่มีปัญหา

## บทสรุป

การปรับระดับการบีบอัดของเวิร์กบุ๊กของคุณโดยใช้ Aspose.Cells สำหรับ .NET เป็นกระบวนการที่ตรงไปตรงมาซึ่งสามารถนำไปสู่การปรับปรุงที่สำคัญในขนาดและประสิทธิภาพของไฟล์ ด้วยการทำตามขั้นตอนที่ระบุไว้ในคู่มือนี้ คุณสามารถนำการบีบอัดไปใช้ในแอปพลิเคชันของคุณได้อย่างมีประสิทธิภาพ ซึ่งช่วยเพิ่มความสามารถในการจัดการไฟล์ Excel ของคุณ

## คำถามที่พบบ่อย

### Aspose.Cells คืออะไร?  
Aspose.Cells เป็นไลบรารีอันทรงพลังสำหรับ .NET ที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงไฟล์ Excel ได้โดยไม่ต้องใช้ Microsoft Excel

### ฉันจะติดตั้ง Aspose.Cells ได้อย่างไร?  
 คุณสามารถดาวน์โหลดและติดตั้ง Aspose.Cells ได้จาก[เว็บไซต์อาโพส](https://releases.aspose.com/cells/net/).

### ระดับการบีบอัดที่มีให้ใช้มีอะไรบ้าง?  
Aspose.Cells รองรับระดับการบีบอัดหลายระดับ ตั้งแต่ระดับ 1 (การบีบอัดต่ำสุด) ถึงระดับ 9 (การบีบอัดสูงสุด)

### ฉันสามารถทดสอบ Aspose.Cells ได้ฟรีหรือไม่?  
 ใช่! คุณสามารถทดลองใช้ Aspose.Cells ได้ฟรี[ที่นี่](https://releases.aspose.com/).

### ฉันสามารถค้นหาการสนับสนุนสำหรับ Aspose.Cells ได้ที่ไหน  
 หากมีคำถามหรือต้องการความช่วยเหลือ โปรดไปที่ฟอรัมสนับสนุน Aspose[ที่นี่](https://forum.aspose.com/c/cells/9).