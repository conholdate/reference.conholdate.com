---
title: การป้องกันแถวในเวิร์กชีตโดยใช้ Aspose.Cells
linktitle: การป้องกันแถวในเวิร์กชีตโดยใช้ Aspose.Cells
second_title: API การประมวลผล Excel ของ Aspose.Cells .NET
description: เรียนรู้วิธีการรักษาความปลอดภัยข้อมูลสำคัญในเวิร์กชีต Excel ของคุณโดยปกป้องแถวเฉพาะโดยใช้ Aspose.Cells สำหรับ .NET บทช่วยสอนที่ครอบคลุมนี้ครอบคลุมทุกอย่างตั้งแต่การตั้งค่าสภาพแวดล้อมของคุณ
type: docs
weight: 18
url: /th/net/tutorials/cells/mastering-worksheet-security/protecting-rows/
---
## การแนะนำ

การทำงานกับไฟล์ Excel ด้วยโปรแกรมมักต้องมีไม่เพียงแค่การจัดการข้อมูลแต่ยังต้องมีการป้องกันข้อมูลด้วย การป้องกันแถวเฉพาะในเวิร์กชีตอาจมีความสำคัญในการปกป้องข้อมูลที่ละเอียดอ่อนหรือป้องกันการแก้ไขโดยไม่ได้ตั้งใจ ในบทช่วยสอนนี้ เราจะสำรวจวิธีป้องกันแถวในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET เราจะแนะนำคุณตลอดขั้นตอนที่จำเป็น ตั้งแต่การตั้งค่าสภาพแวดล้อมของคุณไปจนถึงการนำคุณลักษณะการป้องกันแถวไปใช้ในลักษณะตรงไปตรงมา

## ข้อกำหนดเบื้องต้น
ก่อนที่คุณจะเริ่มต้น ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1.  Aspose.Cells สำหรับ .NET: ดาวน์โหลดและติดตั้งจาก[หน้าดาวน์โหลดเซลล์ Aspose](https://releases.aspose.com/cells/net/).
2. Visual Studio หรือ IDE .NET ใดๆ: คุณต้องมีสภาพแวดล้อมการพัฒนา แนะนำให้ใช้ Visual Studio แต่ IDE ที่เข้ากันได้กับ .NET ตัวใดก็ได้ก็เพียงพอ
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณทำตามและปรับเปลี่ยนโค้ดตัวอย่างตามต้องการ
4.  เอกสาร API ของ Aspose.Cells: ตรวจสอบ[เอกสาร Aspose.Cells สำหรับ .NET](https://reference.aspose.com/cells/net/) เพื่อดูภาพรวมของโครงสร้างและวิธีการของคลาส

เมื่อคุณมีข้อกำหนดเบื้องต้นพร้อมแล้ว เราสามารถดำเนินการใช้งานต่อไปได้

## แพ็คเกจนำเข้าที่จำเป็น
เริ่มต้นด้วยการนำเข้าแพ็คเกจที่จำเป็นลงในโปรเจ็กต์ C# ของคุณ ไลบรารีเหล่านี้มีความจำเป็นสำหรับการโต้ตอบกับไฟล์ Excel

```csharp
using System.IO;
using Aspose.Cells;
```

## ขั้นตอนที่ 1: สร้างสมุดงานและแผ่นงานใหม่
ก่อนที่จะใช้การตั้งค่าการป้องกันใดๆ ให้สร้างเวิร์กบุ๊กใหม่และเลือกเวิร์กชีตที่คุณต้องการทำงานด้วย

```csharp
// กำหนดเส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างไดเร็กทอรีถ้ายังไม่มีอยู่
if (!Directory.Exists(dataDir))
    Directory.CreateDirectory(dataDir);

// สร้างเวิร์กบุ๊กใหม่และเลือกเวิร์กชีตแรก
Workbook wb = new Workbook();
Worksheet sheet = wb.Worksheets[0];
```

## ขั้นตอนที่ 2: กำหนดสไตล์และวัตถุ StyleFlag
กำหนดสไตล์และวัตถุแฟล็กสไตล์ ซึ่งจะช่วยให้คุณปรับเปลี่ยนคุณสมบัติของเซลล์ได้ เช่น การล็อกหรือปลดล็อก

```csharp
// กำหนดสไตล์และวัตถุธงสไตล์
Style style;
StyleFlag flag;
```

## ขั้นตอนที่ 3: ปลดล็อคคอลัมน์ทั้งหมดในเวิร์กชีต
ตามค่าเริ่มต้น เซลล์ทั้งหมดในเวิร์กชีต Excel จะถูกล็อก หากต้องการป้องกันเฉพาะแถวที่ระบุ ให้ปลดล็อกคอลัมน์ทั้งหมดก่อน

```csharp
// วนผ่านคอลัมน์ทั้งหมดและปลดล็อคพวกมัน
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[i].Style;
    style.IsLocked = false;
    flag = new StyleFlag { Locked = true };
    sheet.Cells.Columns[i].ApplyStyle(style, flag);
}
```

## ขั้นตอนที่ 4: ล็อคแถวเฉพาะ
ตอนนี้ ให้ล็อกแถวที่คุณต้องการปกป้อง ในตัวอย่างนี้ เราจะล็อกแถวแรก

```csharp
// ล็อคแถวแรก
style = sheet.Cells.Rows[0].Style;
style.IsLocked = true;
flag = new StyleFlag { Locked = true };
sheet.Cells.ApplyRowStyle(0, style, flag);
```

คุณสามารถทำซ้ำขั้นตอนนี้สำหรับแถวเพิ่มเติมใดๆ ที่คุณต้องการล็อค

## ขั้นตอนที่ 5: ปกป้องแผ่นงาน
เมื่อล็อกแถวที่จำเป็นแล้ว ก็ถึงเวลาปกป้องเวิร์กชีต การดำเนินการนี้จะป้องกันไม่ให้มีการแก้ไขแถวที่ถูกล็อก เว้นแต่จะลบการป้องกันออก

```csharp
// ป้องกันแผ่นงาน
sheet.Protect(ProtectionType.All);
```

## ขั้นตอนที่ 6: บันทึกสมุดงาน
สุดท้าย ให้บันทึกเวิร์กบุ๊กพร้อมการเปลี่ยนแปลงที่นำไปใช้ คุณสามารถเลือกรูปแบบต่างๆ ได้ เช่น Excel 97-2003 หรือเวอร์ชันใหม่กว่า

```csharp
// บันทึกไฟล์ Excel
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

## บทสรุป
ขอแสดงความยินดี! คุณได้เรียนรู้วิธีป้องกันแถวในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว เมื่อทำตามขั้นตอนเหล่านี้ คุณสามารถปลดล็อกหรือล็อกแถวหรือคอลัมน์ตามต้องการ และใช้การป้องกันเพื่อรักษาความสมบูรณ์ของข้อมูลของคุณ

## คำถามที่พบบ่อย
### ฉันจะป้องกันหลายแถวพร้อมกันได้อย่างไร?
คุณสามารถวนซ้ำผ่านดัชนีแถวหลายรายการและปรับใช้รูปแบบการล็อกกับแต่ละรายการได้

### ฉันสามารถตั้งรหัสผ่านสำหรับการป้องกันแผ่นงานได้หรือไม่
 ใช่ คุณสามารถส่งรหัสผ่านไปที่`sheet.Protect()` วิธีการบังคับใช้การป้องกันด้วยรหัสผ่าน

### ฉันสามารถปลดล็อคเซลล์เฉพาะแทนคอลัมน์ทั้งหมดได้ไหม
ใช่ คุณสามารถปลดล็อคเซลล์แต่ละเซลล์ได้โดยการแก้ไขคุณสมบัติรูปแบบของเซลล์แทนที่จะปลดล็อคคอลัมน์ทั้งหมด

### จะเกิดอะไรขึ้นหากฉันพยายามแก้ไขแถวที่ได้รับการป้องกัน?
เมื่อมีการป้องกันแถว Excel จะป้องกันการแก้ไขใดๆ ในเซลล์ที่ถูกล็อค เว้นแต่แผ่นงานนั้นจะไม่ได้รับการป้องกัน

### ฉันสามารถป้องกันช่วงที่เจาะจงภายในแถวหนึ่งได้หรือไม่
 ใช่! คุณสามารถล็อกช่วงแต่ละช่วงในแถวได้โดยการตั้งค่า`IsLocked` คุณสมบัติสำหรับเซลล์เฉพาะภายในช่วงนั้น