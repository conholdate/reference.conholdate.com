---
title: Excel कार्यपुस्तिकाओं के बीच VBA उपयोगकर्ता प्रपत्र और मैक्रोज़ स्थानांतरित करें
linktitle: Excel कार्यपुस्तिकाओं के बीच VBA उपयोगकर्ता प्रपत्र और मैक्रोज़ स्थानांतरित करें
second_title: Aspose.Cells .NET एक्सेल प्रोसेसिंग API
description: .NET के लिए Aspose.Cells का उपयोग करके वर्कबुक के बीच VBA उपयोगकर्ता फ़ॉर्म और मैक्रोज़ को स्थानांतरित करने पर इस व्यापक गाइड के साथ एक्सेल ऑटोमेशन की शक्ति को अनलॉक करें। शुरुआती और अनुभवी डेवलपर्स दोनों के लिए बिल्कुल सही।
type: docs
weight: 11
url: /hi/net/tutorials/cells/mastering-workbook-vba-project/transfer-vba-user-form-and-macro/
---
## परिचय

VBA मैक्रोज़ और यूजर फॉर्म का उपयोग करके अपने एक्सेल अनुभव को बेहतर बनाने के लिए आपकी अंतिम गाइड में आपका स्वागत है! इस ट्यूटोरियल में, हम शक्तिशाली Aspose.Cells for .NET लाइब्रेरी का उपयोग करके एक VBA मैक्रो यूजरफॉर्म डिज़ाइनर को एक वर्कबुक से दूसरे में स्थानांतरित करने का तरीका जानेंगे। चाहे आप एक अनुभवी डेवलपर हों या अभी शुरुआत कर रहे हों, यह चरण-दर-चरण गाइड आपको एक्सेल फ़ाइलों को प्रोग्रामेटिक रूप से संभालने के ज्ञान से लैस करेगी। शुरू करने के लिए तैयार हैं? चलिए शुरू करते हैं!

## आवश्यक शर्तें
इससे पहले कि हम कोडिंग शुरू करें, आइए सुनिश्चित करें कि आपके पास वह सब कुछ है जो आपको चाहिए:

1. C# विकास वातावरण: C# विकास के लिए एक कार्यशील वातावरण, जिसमें विजुअल स्टूडियो अत्यधिक अनुशंसित है।
2.  Aspose.Cells for .NET लाइब्रेरी: सुनिश्चित करें कि Aspose.Cells लाइब्रेरी आपके प्रोजेक्ट में एकीकृत है। आप आसानी से कर सकते हैं[यहाँ पर डाउनलोड करो](https://releases.aspose.com/cells/net/).
3. VBA और एक्सेल मैक्रोज़ का बुनियादी ज्ञान: VBA और एक्सेल मैक्रोज़ कैसे कार्य करते हैं, इसकी जानकारी से इस ट्यूटोरियल के बारे में आपकी समझ बढ़ेगी।
4. उपयोगकर्ता प्रपत्र के साथ एक एक्सेल फ़ाइल: उपयोगकर्ता प्रपत्र युक्त एक एक्सेल कार्यपुस्तिका बनाएं या प्राप्त करें (अधिमानतः मैक्रोज़ सक्षम के साथ, जैसे`.xlsm` फ़ाइलें).

## आवश्यक पैकेज आयात करना
Aspose.Cells द्वारा प्रदान की गई कार्यक्षमताओं का उपयोग करने के लिए, अपनी C# फ़ाइल के शीर्ष पर निम्नलिखित नामस्थान शामिल करें:

```csharp
using System;
using Aspose.Cells;
using Aspose.Cells.Vba;
```

ये नामस्थान आपको Aspose.Cells लाइब्रेरी में एम्बेडेड शक्तिशाली टूल तक पहुंच प्रदान करेंगे।

## चरण 1: अपने स्रोत और आउटपुट निर्देशिकाएँ परिभाषित करें
सबसे पहले, अपनी फ़ाइलों का स्थान निर्धारित करें:

```csharp
// स्रोत और आउटपुट निर्देशिकाएँ परिभाषित करें
string sourceDir = @"Your\Source\Directory\";
string outputDir = @"Your\Output\Directory\";
```

प्लेसहोल्डर पथों को उन वास्तविक निर्देशिकाओं से बदलें जहां आपकी फ़ाइलें संग्रहीत हैं।

## चरण 2: एक खाली लक्ष्य कार्यपुस्तिका बनाएँ
इसके बाद, एक नई कार्यपुस्तिका बनाएं जहां आप उपयोगकर्ता फ़ॉर्म और मैक्रोज़ की प्रतिलिपि बनाएंगे:

```csharp
// एक खाली लक्ष्य कार्यपुस्तिका बनाएँ
Workbook target = new Workbook();
```

यह एक रिक्त कार्यपुस्तिका को आरंभ करता है, जो आगामी डेटा स्थानांतरण के लिए आपके कैनवास के रूप में कार्य करता है।

## चरण 3: अपनी टेम्पलेट कार्यपुस्तिका लोड करें
अपने उपयोगकर्ता प्रपत्र और मैक्रोज़ वाली कार्यपुस्तिका लोड करें:

```csharp
// VBA-मैक्रो डिज़ाइनर उपयोगकर्ता फ़ॉर्म वाली Excel फ़ाइल लोड करें
Workbook templateFile = new Workbook(sourceDir + "sampleDesignerForm.xlsm");
```

समायोजित करना`"sampleDesignerForm.xlsm"` अपनी वास्तविक फ़ाइल के नाम में जोड़ें.

## चरण 4: कार्यपत्रकों को लक्ष्य कार्यपुस्तिका में कॉपी करें
अब, आइए टेम्पलेट से कार्यपत्रकों को लक्ष्य कार्यपुस्तिका में कॉपी करें:

```csharp
// सभी टेम्पलेट वर्कशीट को लक्ष्य कार्यपुस्तिका में कॉपी करें
foreach (Worksheet ws in templateFile.Worksheets)
{
    if (ws.Type == SheetType.Worksheet)
    {
        Worksheet s = target.Worksheets.Add(ws.Name);
        s.Copy(ws);
        // लक्ष्य वर्कशीट के सेल A2 में एक संदेश जोड़ें
        s.Cells["A2"].PutValue("VBA Macro and User Form copied from template to target.");
    }
}
```

यह कोड टेम्पलेट में प्रत्येक वर्कशीट को लूप करता है और उसे लक्ष्य वर्कबुक में कॉपी करता है, जिससे यह सुनिश्चित होता है कि आपका सारा डेटा निर्बाध रूप से स्थानांतरित हो जाए।

## चरण 5: टेम्पलेट से VBA मैक्रोज़ कॉपी करें
इसके बाद, हम UserForm Designer मॉड्यूल सहित VBA मैक्रोज़ को नई कार्यपुस्तिका में कॉपी करेंगे:

```csharp
// VBA-मैक्रो डिज़ाइनर यूजरफ़ॉर्म को टेम्पलेट से लक्ष्य पर कॉपी करें
foreach (VbaModule vbaItem in templateFile.VbaProject.Modules)
{
    if (vbaItem.Name == "ThisWorkbook")
    {
        // इसकार्यपुस्तिका मॉड्यूल कोड की प्रतिलिपि बनाएँ
        target.VbaProject.Modules["ThisWorkbook"].Codes = vbaItem.Codes;
    }
    else
    {
        // अन्य मॉड्यूल कोड और डेटा कॉपी करें
        int vbaMod = target.VbaProject.Modules.Add(vbaItem.Type, vbaItem.Name);
        target.VbaProject.Modules[vbaMod].Codes = vbaItem.Codes;

        if (vbaItem.Type == VbaModuleType.Designer)
        {
            // उपयोगकर्ता फ़ॉर्म डिज़ाइनर संग्रहण प्राप्त करें
            byte[] designerStorage = templateFile.VbaProject.Modules.GetDesignerStorage(vbaItem.Name);
            // लक्ष्य Vba प्रोजेक्ट में डिज़ाइनर संग्रहण जोड़ें
            target.VbaProject.Modules.AddDesignerStorage(vbaItem.Name, designerStorage);
        }
    }
}
```

यह कोड सुनिश्चित करता है कि न केवल कोड बल्कि उपयोगकर्ता फॉर्म डिज़ाइन की भी प्रतिलिपि बनाई जाए, जिससे आपके मैक्रोज़ की कार्यक्षमता सुरक्षित रहे।

## चरण 6: लक्ष्य कार्यपुस्तिका सहेजें
प्रतिलिपि बनाने की प्रक्रिया पूरी करने के बाद, अपनी नई कार्यपुस्तिका सहेजें:

```csharp
// लक्ष्य कार्यपुस्तिका सहेजें
target.Save(outputDir + "outputDesignerForm.xlsm", SaveFormat.Xlsm);
```

आउटपुट फ़ाइल नाम को आवश्यकतानुसार संशोधित करें। यह चरण मैक्रोज़ और उपयोगकर्ता फ़ॉर्म से भरी आपकी अनुकूलित कार्यपुस्तिका बनाता है।

## चरण 7: सफलता की पुष्टि करें
अंत में, कंसोल पर एक सफलता संदेश प्रिंट करें:

```csharp
Console.WriteLine("CopyVBAMacroUserFormDesignerStorageToWorkbook executed successfully.\r\n");
```

यह सरल पंक्ति आपको आश्वस्त करती है कि आपकी प्रक्रिया सुचारू रूप से संपन्न हुई - यह आपकी कड़ी मेहनत की एक आवश्यक पुष्टि है!

## निष्कर्ष
बधाई हो! आपने Aspose.Cells for .NET का उपयोग करके एक कार्यपुस्तिका से दूसरे में VBA मैक्रो उपयोगकर्ता फ़ॉर्म डिज़ाइनर की प्रतिलिपि बनाना सफलतापूर्वक सीख लिया है। हालाँकि यह पहली बार में कठिन लग सकता है, लेकिन अभ्यास आपको कार्यपुस्तिका हेरफेर में कुशल बना देगा। याद रखें, कोडिंग प्रयोग के बारे में है, इसलिए अपनी Excel फ़ाइलों के भीतर विभिन्न कार्यक्षमताओं का पता लगाने में संकोच न करें। यदि आपके पास कोई प्रश्न है या सहायता की आवश्यकता है, तो Aspose फ़ोरम और दस्तावेज़ सहायता के लिए उत्कृष्ट संसाधन हैं।

## अक्सर पूछे जाने वाले प्रश्न

### Aspose.Cells Excel के किस संस्करण का समर्थन करता है?
Aspose.Cells विभिन्न एक्सेल प्रारूपों का समर्थन करता है, जिसमें XLSX, XLSM, CSV, आदि शामिल हैं।

### क्या मैं Aspose.Cells का निःशुल्क उपयोग कर सकता हूँ?
 हाँ! आप लाइब्रेरी का मूल्यांकन करने के लिए निःशुल्क परीक्षण से शुरुआत कर सकते हैं:[मुफ्त परीक्षण](https://releases.aspose.com/).

### क्या मुझे इस कोड को चलाने के लिए विजुअल स्टूडियो की आवश्यकता है?
यद्यपि विजुअल स्टूडियो को इसकी उपयोगकर्ता-अनुकूल सुविधाओं के लिए अनुशंसित किया जाता है, लेकिन कोई भी C# IDE जो .NET विकास का समर्थन करता है, पर्याप्त होगा।

### मैं और अधिक उदाहरण और दस्तावेज कहां पा सकता हूं?
 आप अन्वेषण कर सकते हैं[Aspose.Cells दस्तावेज़ीकरण](https://reference.aspose.com/cells/net/) अधिक उदाहरणों और गहन स्पष्टीकरण के लिए.

### मैं Aspose.Cells का उपयोग करते समय समस्याओं का समाधान कैसे करूँ?
 आपको यहाँ अवश्य जाना चाहिए[Aspose समर्थन मंच](https://forum.aspose.com/c/cells/9) समुदाय और Aspose समर्थन कर्मचारियों से मदद के लिए।