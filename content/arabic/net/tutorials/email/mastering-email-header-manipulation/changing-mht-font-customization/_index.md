---
title: تغيير تخصيص خط MHT باستخدام C#
linktitle: تغيير تخصيص خط MHT باستخدام C#
second_title: واجهة برمجة تطبيقات معالجة البريد الإلكتروني Aspose.Email .NET
description: تعرف على كيفية تغيير الخطوط أثناء تحويل MHT باستخدام Aspose.Email لـ .NET. اتبع هذا الدليل خطوة بخطوة للتخصيص السهل.
type: docs
weight: 11
url: /ar/net/tutorials/email/mastering-email-header-manipulation/changing-mht-font-customization/
---
## مقدمة

في عالم الاتصالات عبر الويب، تعد ملفات MHT (MHTML) طريقة سهلة لتخزين ومشاركة محتوى الويب، مع الصور والروابط والأنماط. ولكن ماذا يحدث عندما تحتاج إلى تحسين ملفات MHT هذه عن طريق تغيير الخطوط؟ بفضل Aspose.Email لـ .NET، أصبحت هذه المهمة سهلة للغاية. في هذا البرنامج التعليمي، سنرشدك خلال عملية تغيير الخطوط أثناء تحويل MHT، خطوة بخطوة. سواء كنت تقوم بتطوير تطبيق يتعامل مع تنسيق البريد الإلكتروني أو كنت ترغب فقط في تخصيص المستندات لشركتك، فإن هذا الدليل سيزودك بالمعرفة التي تحتاج إليها.

## المتطلبات الأساسية

قبل الغوص في الكود، هناك بعض الأساسيات التي يجب عليك إعدادها:

1. Visual Studio: ستحتاج إلى بيئة تطوير متكاملة (IDE) للعمل على مشروع C# الخاص بك.
2.  Aspose.Email لمكتبة .NET: تأكد من تثبيت المكتبة. يمكنك تنزيلها من[وصلة](https://releases.aspose.com/email/net/).
3. .NET Framework: يجب أن يكون مشروعك متوافقًا مع .NET Framework؛ عادةً، يعمل .NET Core أو الإصدارات الأحدث بشكل جيد.

هل قمت بترتيبها؟ رائع! لنبدأ.

## استيراد الحزم

أولاً، تأكد من إعداد مشروعك لاستخدام المساحات الأساسية اللازمة. ستحتاج إلى تضمين ما يلي في أعلى ملف C# الخاص بك:

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Email.Tools;
```

ستتيح لك هذه الحزم الوصول إلى الوظائف اللازمة للعمل مع ملفات MHT وتعديل محتوياتها.

الآن، دعونا نقوم بتفصيل الخطوات المتبعة في تغيير الخطوط أثناء تحويل MHT.

## الخطوة 1: تحميل ملف MHT

 أول شيء عليك فعله هو تحميل ملف MHT الخاص بك إلى`MailMessage` هذا هو المكان الذي يمكنك من خلاله الوصول إلى المحتوى الخاص به والتلاعب به.

```csharp
MailMessage message = MailMessage.Load("input.mht", new MhtmlLoadOptions());
```

 التوضيح: هنا،`"input.mht"` هو المسار إلى ملف MHT الخاص بك.`MhtmlLoadOptions()`يسمح لك بتكوين كيفية تحميل الملف، على سبيل المثال، التعامل مع المرفقات أو الموارد المرتبطة بشكل مختلف.

## الخطوة 2: التكرار من خلال وجهات نظر بديلة

غالبًا ما تحتوي ملفات MHT على وجهات نظر بديلة متعددة، خاصةً إذا كانت تتضمن محتوى HTML. تحتاج إلى التنقل بين هذه العروض للعثور على العرض الذي تريد تعديله.

```csharp
foreach (var alternateView in message.AlternateViews)
{
    if (alternateView.ContentType.MediaType == "text/html")
    {
        var htmlView = (AlternateView)alternateView;
        var linkedResources = htmlView.LinkedResources;
```

 الشرح: أنت تقوم بالتحقق من كل`AlternateView` لمعرفة ما إذا كان من نوع HTML. إذا كان كذلك، فيمكنك الوصول إليه`LinkedResources`حيث يتم عادةً تخزين أي خطوط مرتبطة بـ HTML.

## الخطوة 3: تحديد الخطوط وتخصيصها

الآن بعد أن أصبح لديك إمكانية الوصول إلى الموارد المرتبطة، يمكنك تحديد الموارد التي تمثل الخطوط وتخصيصها حسب الحاجة.

```csharp
foreach (var linkedResource in linkedResources)
{
    if (linkedResource.ContentType.MediaType == "application/x-font-ttf")
    {
        linkedResource.ContentType.Name = "Arial";  // تغيير الخط إلى الخط المطلوب
        linkedResource.TransferEncoding = TransferEncoding.Base64;  // تأكد من ترميزه بشكل صحيح
    }
}
```

 الشرح: تتحقق هذه الحلقة من أن نوع المحتوى للمورد المرتبط هو خط TrueType. إذا كان مطابقًا، يمكنك تغيير اسم الخط إلى ما تريده (مثل "Arial" في هذا المثال).`TransferEncoding`ينبغي أيضًا ضبط ذلك للتأكد من ترميز بيانات الخط بشكل صحيح عند حفظ المستند.

## الخطوة 4: احفظ ملف MHT المحدث

بعد تخصيص الخطوط، حان الوقت لحفظ ملف MHT المعدّل. ستحتاج إلى التأكد من استخدام خيارات الحفظ الصحيحة للحفاظ على سلامة ملفك.

```csharp
message.Save("output.mht", SaveOptions.DefaultMhtml);
```

 الشرح: في هذا السطر من التعليمات البرمجية،`"output.mht"` هو اسم الملف الذي تريد حفظ المحتوى المحدث فيه. باستخدام`SaveOptions.DefaultMhtml` ويضمن أن الملف الجديد يحافظ على تنسيق MHT.

## خاتمة

إن تغيير الخطوط في ملفات MHT يمكن أن يعزز بشكل كبير من مظهر وشكل مستنداتك. من خلال الاستفادة من Aspose.Email لـ .NET، يمكنك بسهولة تحميل ملفات MHT وتعديل محتواها وحفظ التغييرات باستخدام بضعة أسطر فقط من التعليمات البرمجية. سواء كنت تعمل على مشروع شخصي أو تطبيق أكبر، فإن إتقان هذه المهارات يمكن أن يحسن من طريقة عرض المعلومات.

## الأسئلة الشائعة

### ما هو تنسيق MHT؟
MHT هو تنسيق أرشيف لصفحات الويب يخزن مستندات HTML والصور والموارد الأخرى في ملف واحد.

### هل يمكنني تغيير جوانب أخرى من ملفات MHT باستخدام Aspose؟
بالتأكيد! يتيح لك Aspose.Email تعديل كل جانب تقريبًا من جوانب ملفات MHT، بما في ذلك المرفقات والرؤوس والمزيد.

### هل Aspose.Email لـ .NET مجاني؟
 يقدم Aspose نسخة تجريبية مجانية، لكن الإصدار الكامل يتطلب ترخيصًا. يمكنك الحصول على ترخيص مؤقت من[هنا](https://purchase.aspose.com/temporary-license/).

### أين يمكنني العثور على مزيد من الوثائق حول Aspose.Email؟
 يمكنك العثور على وثائق وأمثلة شاملة في[صفحة توثيق البريد الإلكتروني Aspose](https://reference.aspose.com/email/net/).

### ماذا لو واجهت مشاكل أثناء استخدام Aspose؟
 إذا واجهت أي مشاكل، يمكنك التواصل للحصول على الدعم على[منتدى دعم Aspose](https://forum.aspose.com/c/email/12/).