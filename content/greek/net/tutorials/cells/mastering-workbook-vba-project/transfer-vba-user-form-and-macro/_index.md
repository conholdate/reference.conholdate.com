---
title: Μεταφέρετε φόρμες χρήστη VBA και μακροεντολές μεταξύ βιβλίων εργασίας του Excel
linktitle: Μεταφέρετε φόρμες χρήστη VBA και μακροεντολές μεταξύ βιβλίων εργασίας του Excel
second_title: Aspose.Cells .NET Excel Processing API
description: Ξεκλειδώστε τη δύναμη του αυτοματισμού του Excel με αυτόν τον περιεκτικό οδηγό για τη μεταφορά φορμών χρήστη και μακροεντολών VBA μεταξύ βιβλίων εργασίας χρησιμοποιώντας το Aspose.Cells για .NET. Ιδανικό τόσο για αρχάριους όσο και για έμπειρους προγραμματιστές.
type: docs
weight: 11
url: /el/net/tutorials/cells/mastering-workbook-vba-project/transfer-vba-user-form-and-macro/
---
## Εισαγωγή

Καλώς ήρθατε στον απόλυτο οδηγό σας για τη βελτίωση της εμπειρίας σας στο Excel χρησιμοποιώντας μακροεντολές VBA και φόρμες χρήστη! Σε αυτό το σεμινάριο, θα εξερευνήσουμε πώς να μεταφέρετε ένα VBA Macro UserForm Designer από ένα βιβλίο εργασίας σε άλλο χρησιμοποιώντας την ισχυρή βιβλιοθήκη Aspose.Cells για .NET. Είτε είστε έμπειρος προγραμματιστής είτε μόλις ξεκινάτε, αυτός ο οδηγός βήμα προς βήμα θα σας εξοπλίσει με τις γνώσεις για να χειρίζεστε αρχεία Excel μέσω προγραμματισμού. Είστε έτοιμοι να βουτήξετε; Ας ξεκινήσουμε!

## Προαπαιτούμενα
Πριν προχωρήσουμε στην κωδικοποίηση, ας βεβαιωθούμε ότι έχετε όλα όσα χρειάζεστε:

1. C# Development Environment: Ένα περιβάλλον εργασίας για ανάπτυξη C#, με το Visual Studio να συνιστάται ιδιαίτερα.
2.  Aspose.Cells for .NET Library: Βεβαιωθείτε ότι έχετε ενσωματώσει τη βιβλιοθήκη Aspose.Cells στο έργο σας. Μπορείτε εύκολα[κατεβάστε το εδώ](https://releases.aspose.com/cells/net/).
3. Βασικές γνώσεις μακροεντολών VBA και Excel: Η εξοικείωση με τη VBA και τον τρόπο λειτουργίας των μακροεντολών του Excel θα βελτιώσει την κατανόηση αυτού του σεμιναρίου.
4. Ένα αρχείο Excel με φόρμα χρήστη: Δημιουργήστε ή αποκτήστε ένα βιβλίο εργασίας του Excel που περιέχει μια φόρμα χρήστη (κατά προτίμηση με ενεργοποιημένες μακροεντολές, π.χ.`.xlsm` αρχεία).

## Εισαγωγή απαιτούμενων πακέτων
Για να χρησιμοποιήσετε τις λειτουργίες που παρέχονται από το Aspose.Cells, συμπεριλάβετε τους ακόλουθους χώρους ονομάτων στην κορυφή του αρχείου C#:

```csharp
using System;
using Aspose.Cells;
using Aspose.Cells.Vba;
```

Αυτοί οι χώροι ονομάτων θα σας δώσουν πρόσβαση στα ισχυρά εργαλεία που είναι ενσωματωμένα στη βιβλιοθήκη Aspose.Cells.

## Βήμα 1: Καθορίστε τους καταλόγους προέλευσης και εξόδου σας
Αρχικά, καθορίστε τις τοποθεσίες των αρχείων σας:

```csharp
// Καθορίστε τους καταλόγους προέλευσης και εξόδου
string sourceDir = @"Your\Source\Directory\";
string outputDir = @"Your\Output\Directory\";
```

Αντικαταστήστε τις διαδρομές κράτησης θέσης με τους πραγματικούς καταλόγους όπου είναι αποθηκευμένα τα αρχεία σας.

## Βήμα 2: Δημιουργήστε ένα κενό βιβλίο εργασίας στόχου
Στη συνέχεια, δημιουργήστε ένα νέο βιβλίο εργασίας όπου θα αντιγράψετε τη φόρμα χρήστη και τις μακροεντολές:

```csharp
// Δημιουργήστε ένα κενό βιβλίο εργασίας στόχου
Workbook target = new Workbook();
```

Αυτό προετοιμάζει ένα κενό βιβλίο εργασίας, το οποίο λειτουργεί ως καμβάς σας για την επερχόμενη μεταφορά δεδομένων.

## Βήμα 3: Φορτώστε το βιβλίο εργασίας του προτύπου σας
Φορτώστε το βιβλίο εργασίας που περιέχει τη φόρμα χρήστη και τις μακροεντολές σας:

```csharp
// Φορτώστε το αρχείο Excel που περιέχει τη φόρμα χρήστη VBA-Macro Designer
Workbook templateFile = new Workbook(sourceDir + "sampleDesignerForm.xlsm");
```

Προσαρμόζω`"sampleDesignerForm.xlsm"` στο όνομα του πραγματικού σας αρχείου.

## Βήμα 4: Αντιγράψτε τα φύλλα εργασίας στο βιβλίο εργασίας στόχου
Τώρα, ας αντιγράψουμε τα φύλλα εργασίας από το πρότυπο στο βιβλίο εργασίας προορισμού:

```csharp
// Αντιγράψτε όλα τα φύλλα εργασίας προτύπων στο βιβλίο εργασίας προορισμού
foreach (Worksheet ws in templateFile.Worksheets)
{
    if (ws.Type == SheetType.Worksheet)
    {
        Worksheet s = target.Worksheets.Add(ws.Name);
        s.Copy(ws);
        // Προσθέστε ένα μήνυμα στο κελί A2 του φύλλου εργασίας προορισμού
        s.Cells["A2"].PutValue("VBA Macro and User Form copied from template to target.");
    }
}
```

Αυτός ο κώδικας περνά μέσα από κάθε φύλλο εργασίας του προτύπου και το αντιγράφει στο βιβλίο εργασίας προορισμού, διασφαλίζοντας ότι όλα τα δεδομένα σας μεταφέρονται απρόσκοπτα.

## Βήμα 5: Αντιγράψτε τις μακροεντολές VBA από το Πρότυπο
Στη συνέχεια, θα αντιγράψουμε τις μακροεντολές VBA, συμπεριλαμβανομένων των λειτουργικών μονάδων UserForm Designer, στο νέο βιβλίο εργασίας:

```csharp
// Αντιγράψτε τη φόρμα χρήστη VBA-Macro Designer από το Πρότυπο στον Στόχο
foreach (VbaModule vbaItem in templateFile.VbaProject.Modules)
{
    if (vbaItem.Name == "ThisWorkbook")
    {
        // Αντιγράψτε τον κωδικό ενότητας ThisWorkbook
        target.VbaProject.Modules["ThisWorkbook"].Codes = vbaItem.Codes;
    }
    else
    {
        // Αντιγράψτε τον κωδικό και τα δεδομένα άλλων μονάδων
        int vbaMod = target.VbaProject.Modules.Add(vbaItem.Type, vbaItem.Name);
        target.VbaProject.Modules[vbaMod].Codes = vbaItem.Codes;

        if (vbaItem.Type == VbaModuleType.Designer)
        {
            // Αποκτήστε το χώρο αποθήκευσης σχεδιαστή φόρμας χρήστη
            byte[] designerStorage = templateFile.VbaProject.Modules.GetDesignerStorage(vbaItem.Name);
            // Προσθέστε τον χώρο αποθήκευσης σχεδιαστή στο Vba Project-στόχο
            target.VbaProject.Modules.AddDesignerStorage(vbaItem.Name, designerStorage);
        }
    }
}
```

Αυτός ο κώδικας διασφαλίζει ότι όχι μόνο ο κώδικας αλλά και η σχεδίαση της φόρμας χρήστη αντιγράφεται, διατηρώντας τη λειτουργικότητα των μακροεντολών σας.

## Βήμα 6: Αποθηκεύστε το βιβλίο εργασίας στόχου
Αφού ολοκληρώσετε τη διαδικασία αντιγραφής, αποθηκεύστε το νέο σας βιβλίο εργασίας:

```csharp
// Αποθηκεύστε το βιβλίο εργασίας προορισμού
target.Save(outputDir + "outputDesignerForm.xlsm", SaveFormat.Xlsm);
```

Τροποποιήστε το όνομα αρχείου εξόδου όπως απαιτείται. Αυτό το βήμα δημιουργεί το προσαρμοσμένο βιβλίο εργασίας σας γεμάτο με μακροεντολές και φόρμες χρήστη.

## Βήμα 7: Επιβεβαιώστε την επιτυχία
Τέλος, εκτυπώστε ένα μήνυμα επιτυχίας στην κονσόλα:

```csharp
Console.WriteLine("CopyVBAMacroUserFormDesignerStorageToWorkbook executed successfully.\r\n");
```

Αυτή η απλή γραμμή σας καθησυχάζει ότι η διαδικασία σας πήγε ομαλά—μια ουσιαστική επιβεβαίωση της σκληρής δουλειάς σας!

## Σύναψη
Συγχαρητήρια! Μάθατε με επιτυχία πώς να αντιγράφετε ένα VBA Macro User Form Designer από το ένα βιβλίο εργασίας στο άλλο χρησιμοποιώντας το Aspose.Cells για .NET. Αν και μπορεί να φαίνεται τρομακτικό στην αρχή, η πρακτική θα σας κάνει να είστε ικανοί στους χειρισμούς του βιβλίου εργασίας. Θυμηθείτε, η κωδικοποίηση έχει να κάνει με τον πειραματισμό, επομένως μη διστάσετε να εξερευνήσετε διαφορετικές λειτουργίες στα αρχεία σας Excel. Εάν έχετε οποιεσδήποτε ερωτήσεις ή χρειάζεστε βοήθεια, τα φόρουμ και η τεκμηρίωση του Aspose είναι εξαιρετικοί πόροι για υποστήριξη.

## Συχνές ερωτήσεις

### Ποιες εκδόσεις του Excel υποστηρίζει το Aspose.Cells;
Το Aspose.Cells υποστηρίζει διάφορες μορφές Excel, συμπεριλαμβανομένων των XLSX, XLSM, CSV και άλλων.

### Μπορώ να χρησιμοποιήσω το Aspose.Cells δωρεάν;
 Ναί! Μπορείτε να ξεκινήσετε με μια δωρεάν δοκιμή για να αξιολογήσετε τη βιβλιοθήκη:[Δωρεάν δοκιμή](https://releases.aspose.com/).

### Χρειάζομαι το Visual Studio για να εκτελέσω αυτόν τον κώδικα;
Ενώ το Visual Studio συνιστάται για τις φιλικές προς το χρήστη λειτουργίες του, αρκεί οποιοδήποτε C# IDE που υποστηρίζει ανάπτυξη .NET.

### Πού μπορώ να βρω περισσότερα παραδείγματα και τεκμηρίωση;
 Μπορείτε να εξερευνήσετε το[Aspose.Cells Documentation](https://reference.aspose.com/cells/net/) για περισσότερα παραδείγματα και εμπεριστατωμένες εξηγήσεις.

### Πώς μπορώ να επιλύσω προβλήματα κατά τη χρήση του Aspose.Cells;
 Θα πρέπει να επισκεφθείτε το[Aspose Support Forum](https://forum.aspose.com/c/cells/9) για βοήθεια από την κοινότητα και το προσωπικό υποστήριξης της Aspose.