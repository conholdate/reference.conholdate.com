---
title: Создайте и подпишите новую строку подписи
linktitle: Создайте и подпишите новую строку подписи
second_title: API обработки документов Aspose.Words
description: Узнайте, как легко добавить цифровую подпись в документы Word с помощью Aspose.Words для .NET. Это всеобъемлющее руководство охватывает все от настройки среды и вставки строки подписи до сохранения и проверки подписанных документов.
type: docs
weight: 10
url: /ru/net/tutorials/words/digital-signatures/create-and-sign-new-signature-line/
---
## Введение

Хотите добавить цифровую подпись в документ Word? С Aspose.Words для .NET это проще, чем вы могли бы подумать! Этот урок проведет вас через этапы настройки среды, добавления строки подписи и цифровой подписи документа. Давайте начнем!

## Предпосылки

Прежде чем приступить к изучению кода, убедитесь, что у вас есть следующее:

1.  Aspose.Words для .NET -[Загрузить здесь](https://releases.aspose.com/words/net/).
2. Среда разработки .NET - Visual Studio идеально подходит для этой задачи.
3. Документ для подписи — вы можете создать новый документ Word или использовать существующий.
4.  Файл сертификата - А`.pfx` файл необходим для цифровых подписей.
5. Изображение строки подписи (необязательно) — вы можете включить файл изображения для подписи.

## Импорт требуемых пространств имен

Чтобы использовать функциональные возможности Aspose.Words, вам необходимо импортировать следующие пространства имен:

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## Шаг 1: Настройка каталога документов

Начните с определения пути к вашему каталогу документов. Это будет то место, где вы будете сохранять и извлекать свои документы.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // Укажите путь к каталогу вашего документа
```

## Шаг 2: Создание нового документа

Далее, давайте создадим новый документ Word. Этот документ будет служить холстом для вашей подписи.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 3: Вставка строки подписи

 Теперь используйте`DocumentBuilder` класс для вставки строки подписи в ваш документ:

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## Шаг 4: Сохранение документа

После того, как вы вставили строку подписи, сохраните документ. Это важный шаг перед подписанием.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## Шаг 5: Настройка параметров подписи

Настройте параметры процесса подписания. Это включает указание идентификатора строки подписи и необязательного изображения для отображения с подписью.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf") // Путь к вашему изображению
};
```

## Шаг 6: Загрузка сертификата

Загрузите файл сертификата, необходимый для подписания документа:

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "your_certificate.pfx", "your_password"); // Измените имя файла и пароль.
```

## Шаг 7: Подписание документа

 Наконец, подпишите документ, используя`DigitalSignatureUtil` класс. Сохраните подписанный документ под новым именем для дальнейшего использования.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.SignedDocument.docx", certHolder, signOptions);
```

## Заключение

Поздравляем! Вы успешно создали документ Word, добавили строку подписи и поставили на него цифровую подпись с помощью Aspose.Words for .NET. Этот мощный инструмент упрощает автоматизацию документов, гарантируя, что ваши контракты и официальные документы будут надежно подписаны и аутентифицированы.

## Часто задаваемые вопросы

### Могу ли я использовать другие форматы изображений для строки подписи?

Да, вы можете использовать различные форматы изображений, включая PNG, JPG и BMP.

###  Необходимо ли использовать`.pfx` file for the certificate?

 Да, а`.pfx` Файл — это стандартный формат для хранения сертификатов и закрытых ключей для цифровых подписей.

### Могу ли я добавить несколько строк подписи в один документ?

Конечно! Вы можете вставить несколько строк подписи, повторяя шаг вставки по мере необходимости.

### Что делать, если у меня нет цифрового сертификата?

Вам необходимо получить цифровой сертификат от доверенного центра сертификации или сгенерировать его с помощью таких инструментов, как OpenSSL.

### Как проверить цифровую подпись в документе?

Вы можете проверить цифровую подпись, открыв подписанный документ в Word и проверив данные подписи, чтобы подтвердить ее подлинность и целостность.