---
title: Создать новую строку цифровой подписи и задать идентификатор поставщика
linktitle: Создать новую строку цифровой подписи и задать идентификатор поставщика
second_title: API обработки документов Aspose.Words
description: Узнайте, как программно добавлять строки подписи в документы Word с помощью Aspose.Words для .NET. Это всеобъемлющее руководство охватывает все от настройки среды разработки до вставки строк подписи и безопасного подписания документов.
type: docs
weight: 10
url: /ru/net/tutorials/words/digital-signatures/create-new-digital-signature-line-and-set-provider-id/
---
## Введение

Привет, энтузиасты технологий! Вы когда-нибудь хотели автоматизировать включение строк подписи в документы Word? Сегодня мы рассмотрим, как этого добиться с помощью Aspose.Words for .NET. Это пошаговое руководство проведет вас через создание строки подписи и настройку идентификатора поставщика, что сделает ваши задачи по обработке документов более эффективными и оптимизированными.

## Предпосылки

Прежде чем приступить к работе, давайте убедимся, что у вас все настроено:

1.  Aspose.Words для .NET: если вы еще не установили его, загрузите его[здесь](https://releases.aspose.com/words/net/).
2. Среда разработки: используйте Visual Studio или любую среду разработки C#.
3. .NET Framework: Убедитесь, что на вашем компьютере установлен .NET Framework.
4. Сертификат PFX: для подписания документов вам понадобится сертификат PFX, который можно получить в доверенном центре сертификации.

## Импорт необходимых пространств имен

Для начала импортируйте необходимые пространства имен в свой проект C#:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Signing;
using System;
```

Теперь давайте рассмотрим детали создания новой строки подписи и настройки идентификатора поставщика.

## Шаг 1: Создайте новый документ

Для начала нам нужно создать новый документ Word, который послужит основой для нашей подписи:

```csharp
// Укажите путь к каталогу ваших документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

 Здесь мы инициализируем новый`Document` и а`DocumentBuilder`, что позволяет нам легко добавлять элементы.

## Шаг 2: Определите параметры строки подписи

Далее мы определим параметры строки подписи, включая имя подписавшего, должность, адрес электронной почты и другие соответствующие данные:

```csharp
SignatureLineOptions signatureLineOptions = new SignatureLineOptions
{
    Signer = "vderyushev",
    SignerTitle = "QA",
    Email = "vderyushev@aspose.com",
    ShowDate = true,
    DefaultInstructions = false,
    Instructions = "Please sign here.",
    AllowComments = true
};
```

Эти опции помогают персонализировать строку подписи, делая ее четкой и профессиональной.

## Шаг 3: Вставьте строку подписи

Теперь, когда все параметры готовы, мы можем вставить строку подписи в документ:

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(signatureLineOptions).SignatureLine;
signatureLine.ProviderId = Guid.Parse("CF5A7BB4-8F3C-4756-9DF6-BEF7F13259A2");
```

 The`InsertSignatureLine` Метод добавляет строку подписи, и мы присваиваем ей уникальный идентификатор провайдера.

## Шаг 4: Сохраните документ.

После вставки строки подписи сохраним документ:

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLineProviderId.docx");
```

Это сохранит ваш документ с новой добавленной строкой подписи.

## Шаг 5: Настройте параметры подписи

Теперь настроим параметры подписи, включая идентификатор строки подписи, идентификатор провайдера, комментарии и время подписания:

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    ProviderId = signatureLine.ProviderId,
    Comments = "Document was signed by vderyushev",
    SignTime = DateTime.Now
};
```

Эти настройки гарантируют, что документ подписан с правильными данными.

## Шаг 6: Создайте держателя сертификата

Для подписания документа нам необходимо создать держателя сертификата, используя сертификат PFX:

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "morzal.pfx", "aw");
```

 Заменять`"morzal.pfx"` с вашим фактическим именем файла сертификата и`"aw"` с паролем вашего сертификата.

## Шаг 7: Подпишите документ

Наконец, мы подпишем документ с помощью утилиты цифровой подписи:

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLineProviderId.docx", 
    dataDir + "SignDocuments.CreateNewSignatureLineAndSetProviderId.docx", certHolder, signOptions);
```

Этот процесс подписывает документ и сохраняет его как новый файл.

## Заключение

Поздравляем! Вы успешно создали строку подписи и установили идентификатор поставщика в документе Word с помощью Aspose.Words для .NET. Эта мощная библиотека упрощает задачи обработки документов, делая ваш рабочий процесс более эффективным. Попробуйте и посмотрите, как она может улучшить ваши проекты!

## Часто задаваемые вопросы

### Могу ли я настроить внешний вид строки подписи?
 Конечно! Вы можете настроить различные параметры в`SignatureLineOptions` в соответствии с вашим стилем и требованиями.

### Что делать, если у меня нет сертификата PFX?
Вам необходимо получить его в доверенном центре сертификации, поскольку он необходим для цифровой подписи документов.

### Могу ли я добавить в документ несколько строк подписи?
Да, вы можете добавить несколько строк подписи, повторив процесс вставки с различными параметрами.

### Совместим ли Aspose.Words для .NET с .NET Core?
Да, Aspose.Words для .NET поддерживает .NET Core, что делает его универсальным для различных сред разработки.

### Насколько безопасны цифровые подписи?
Цифровые подписи, созданные с помощью Aspose.Words, обладают высокой степенью безопасности при условии использования действительного и доверенного сертификата.