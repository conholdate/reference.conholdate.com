---
title: Создание среза для сводной таблицы в Aspose.Cells .NET
linktitle: Создать срез для сводной таблицы в Aspose.Cells .NET
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как преобразовать сводные таблицы Excel с помощью интерактивных срезов с помощью Aspose.Cells для .NET. Это полное руководство проведет вас через весь процесс.
type: docs
weight: 12
url: /ru/net/tutorials/cells/mastering-excel-slicers-management/creating-slicer-for-pivot-table/
---
## Введение

В сегодняшнем ландшафте, управляемом данными, сводные таблицы необходимы для обобщения и анализа больших наборов данных. Но зачем ограничиваться базовыми сводками? С помощью срезов вы можете добавить интерактивности в свои сводные таблицы, позволяя пользователям фильтровать данные без усилий — как иметь удаленное управление для ваших отчетов Excel! В этом руководстве мы рассмотрим шаги по созданию среза для сводной таблицы с помощью Aspose.Cells для .NET. Итак, берите свой кофе, и давайте начнем!

## Предпосылки

Прежде чем приступить к работе, убедитесь, что у вас есть следующее:

1. Aspose.Cells для .NET: Загрузите его с сайта[Страница релизов Aspose](https://releases.aspose.com/cells/net/).
2. Visual Studio или IDE: используйте любую IDE, поддерживающую разработку .NET, при этом Visual Studio является популярным выбором.
3. Базовые знания C#: знакомство с C# поможет вам легко разобраться в кодировании.
4.  Пример файла Excel: мы будем использовать файл с именем`sampleCreateSlicerToPivotTable.xlsx` содержащий сводную таблицу.

Как только все будет готово, давайте импортируем необходимые пакеты.

## Импорт пакетов

В верхней части файла кода включите следующие пространства имен для доступа к функциям Aspose.Cells:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

## Шаг 1: Определите исходные и выходные каталоги

Сначала укажите пути для входных и выходных файлов:

```csharp
// Исходный каталог
string sourceDir = "Your Document Directory"; // Замените на путь к исходному каталогу.
// Выходной каталог
string outputDir = "Your Document Directory"; // Замените на путь к выходному каталогу.
```

## Шаг 2: Загрузите рабочую книгу

Затем загрузите книгу Excel, содержащую вашу сводную таблицу:

```csharp
// Загрузите пример файла Excel, содержащего сводную таблицу.
Workbook wb = new Workbook(sourceDir + "sampleCreateSlicerToPivotTable.xlsx");
```

## Шаг 3: Получите доступ к первому рабочему листу

Теперь давайте откроем рабочий лист, на котором расположена сводная таблица:

```csharp
// Откройте первый рабочий лист.
Worksheet ws = wb.Worksheets[0];
```

## Шаг 4: Доступ к сводной таблице

Извлечем сводную таблицу, в которую хотим добавить срез:

```csharp
// Откройте первую сводную таблицу на рабочем листе.
Aspose.Cells.Pivot.PivotTable pt = ws.PivotTables[0];
```

## Шаг 5: Добавьте слайсер

А теперь самое интересное — добавление среза! Этот шаг привязывает срез к базовому полю сводной таблицы:

```csharp
// Добавьте срез, связанный со сводной таблицей в ячейке B22.
int idx = ws.Slicers.Add(pt, "B22", pt.BaseFields[0]);
```

## Шаг 6: Доступ к недавно добавленному слайсеру

Хорошей практикой является сохранение ссылки на вновь созданный слайсер для любых будущих изменений:

```csharp
// Получите доступ к недавно добавленному слайсеру из коллекции слайсеров.
Aspose.Cells.Slicers.Slicer slicer = ws.Slicers[idx];
```

## Шаг 7: Сохраните рабочую книгу

Наконец, сохраните свою работу в желаемых форматах:

```csharp
// Сохраните книгу в формате XLSX.
wb.Save(outputDir + "outputCreateSlicerToPivotTable.xlsx", SaveFormat.Xlsx);
// Сохраните книгу в формате XLSB.
wb.Save(outputDir + "outputCreateSlicerToPivotTable.xlsb", SaveFormat.Xlsb);
```

## Шаг 8: Выполните код

Для подтверждения того, что все выполнено успешно, выведите сообщение:

```csharp
Console.WriteLine("CreateSlicerToPivotTable executed successfully.");
```

## Заключение

Поздравляем! Вы успешно создали срез для сводной таблицы с помощью Aspose.Cells for .NET. Эта функция повышает интерактивность ваших отчетов Excel, делая их более удобными для пользователя и визуально привлекательными. 

## Часто задаваемые вопросы

### Что такое срез в Excel?
Срез — это визуальный фильтр, позволяющий пользователям быстро фильтровать данные в сводной таблице.

### Можно ли добавить несколько срезов в сводную таблицу?
Да, вы можете добавить несколько срезов для фильтрации различных полей в сводной таблице.

### Можно ли использовать Aspose.Cells бесплатно?
Aspose.Cells — платная библиотека, но вы можете попробовать ее бесплатно в течение пробного периода.

### Где я могу найти дополнительную документацию по Aspose.Cells?
 Посетите[Документация Aspose.Cells](https://reference.aspose.com/cells/net/) для получения более подробной информации.

### Как я могу получить поддержку по Aspose.Cells?
 Вы можете обратиться за помощью по адресу[Форум Aspose](https://forum.aspose.com/c/cells/9).