---
title: Добавление новой цифровой подписи к подписанному файлу Excel
linktitle: Добавление новой цифровой подписи к подписанному файлу Excel
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как добавить новую цифровую подпись к существующему подписанному файлу Excel с помощью Aspose.Cells для .NET. Это полное руководство охватывает все предварительные условия, пошаговые инструкции и пример кода.
type: docs
weight: 12
url: /ru/net/tutorials/cells/mastering-workbook-operations/adding-new-digital-signature-to-signed-excel-file/
---
## Введение

В современном цифровом ландшафте обеспечение подлинности и целостности документов важнее, чем когда-либо. Цифровые подписи обеспечивают надежный способ проверки того, что документ не был изменен и что он исходит из законного источника. Если вы работаете с файлами Excel в .NET и вам нужно добавить новую цифровую подпись в уже подписанный файл, это руководство для вас! Мы рассмотрим процесс добавления цифровой подписи в существующий подписанный файл Excel с помощью Aspose.Cells для .NET.

## Предпосылки

Прежде чем приступить к реализации, убедитесь, что у вас есть следующее:

1.  Aspose.Cells для .NET: Загрузите и установите Aspose.Cells с сайта[страница релиза](https://releases.aspose.com/cells/net/).
2. .NET Framework: убедитесь, что на вашем компьютере установлен .NET Framework и вы знакомы с основными концепциями программирования .NET.
3. Цифровой сертификат: Получите действительный цифровой сертификат в формате .pfx. Для тестирования вы можете создать самоподписанный сертификат.
4. Среда разработки: используйте IDE, например Visual Studio, для написания и выполнения кода C#.
5. Пример файла Excel: у вас должен быть существующий файл Excel с цифровой подписью, который будет использоваться для добавления новой подписи.

Выполнив все эти предварительные условия, давайте перейдем к коду!

## Импорт необходимых пакетов

В верхней части файла C# включите следующие пространства имен для доступа к требуемым классам и методам:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

## Шаг 1: Определите свои каталоги

Укажите каталоги для исходных файлов и место сохранения выходного файла:

```csharp
// Исходный каталог
string sourceDir = "Your Document Directory"; // Замените на ваш реальный каталог
// Выходной каталог
string outputDir = "Your Document Directory"; // Замените на ваш реальный каталог
```

## Шаг 2: Загрузите существующую подписанную рабочую книгу

Загрузите уже подписанную книгу Excel:

```csharp
// Загрузите рабочую книгу, которая уже имеет цифровую подпись.
Aspose.Cells.Workbook workbook = new Aspose.Cells.Workbook(sourceDir + "sampleDigitallySignedByCells.xlsx");
```

## Шаг 3: Создайте коллекцию цифровых подписей

Создайте коллекцию для управления вашими цифровыми подписями:

```csharp
//Создать коллекцию цифровых подписей
Aspose.Cells.DigitalSignatures.DigitalSignatureCollection dsCollection = new Aspose.Cells.DigitalSignatures.DigitalSignatureCollection();
```

## Шаг 4: Загрузите свой сертификат

Загрузите свой цифровой сертификат, который будет использоваться для создания новой подписи:

```csharp
// Файл сертификата и его пароль
string certFileName = sourceDir + "AsposeDemo.pfx"; // Ваш файл сертификата
string password = "aspose"; // Ваш пароль сертификата

// Создать новый сертификат
System.Security.Cryptography.X509Certificates.X509Certificate2 certificate = new System.Security.Cryptography.X509Certificates.X509Certificate2(certFileName, password);
```

## Шаг 5: Создайте новую цифровую подпись

Теперь создайте новую цифровую подпись и добавьте ее в свою коллекцию:

```csharp
// Создайте новую цифровую подпись и добавьте ее в коллекцию
Aspose.Cells.DigitalSignatures.DigitalSignature signature = new Aspose.Cells.DigitalSignatures.DigitalSignature(certificate, "Aspose.Cells added new digital signature in existing digitally signed workbook.", DateTime.Now);
dsCollection.Add(signature);
```

## Шаг 6: Добавьте коллекцию подписей в рабочую книгу

Добавьте коллекцию цифровых подписей в рабочую книгу:

```csharp
// Добавить сбор цифровых подписей в рабочую книгу
workbook.AddDigitalSignature(dsCollection);
```

## Шаг 7: Сохраните рабочую книгу

Сохраните книгу с новой включенной цифровой подписью:

```csharp
// Сохраните рабочую книгу
workbook.Save(outputDir + "outputDigitallySignedByCells.xlsx");
workbook.Dispose();
```

## Шаг 8: Подтвердите успех

Предоставьте отзыв после успешного выполнения:

```csharp
Console.WriteLine("Successfully added a digital signature to the existing signed Excel file.");
```

## Заключение

Поздравляем! Вы успешно добавили новую цифровую подпись в уже подписанный файл Excel с помощью Aspose.Cells for .NET. Этот процесс повышает безопасность ваших документов и гарантирует их подлинность и целостность.

## Часто задаваемые вопросы

### Что такое цифровая подпись?

Цифровая подпись — это математическая схема, которая проверяет подлинность и целостность цифровых сообщений или документов, гарантируя, что они не были изменены, и подтверждая личность подписавшего.

### Нужен ли мне специальный сертификат для создания цифровой подписи?

Да, для создания действительной цифровой подписи необходим цифровой сертификат, выданный доверенным центром сертификации (ЦС).

### Могу ли я использовать самоподписанный сертификат для тестирования?

Конечно! Вы можете использовать самоподписанный сертификат для целей разработки и тестирования, но для производства рекомендуется использовать сертификат от доверенного центра сертификации.

### Что произойдет, если я попытаюсь добавить подпись к неподписанному документу?

Если вы попытаетесь добавить цифровую подпись к документу, который еще не подписан, это сработает без проблем, но исходная подпись будет отсутствовать.

### Где я могу найти более подробную информацию об Aspose.Cells?

 Подробные руководства и ссылки на API см.[Документация Aspose.Cells](https://reference.aspose.com/cells/net/).