---
title: Настройка уровня сжатия в рабочей книге
linktitle: Настройка уровня сжатия в рабочей книге
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как эффективно управлять большими файлами Excel, регулируя уровни сжатия с помощью Aspose.Cells для .NET. Это пошаговое руководство охватывает все, от настройки каталогов до измерения времени сжатия, помогая вам оптимизировать размер файла и повысить производительность.
type: docs
weight: 14
url: /ru/net/tutorials/cells/mastering-workbook-operations/adjusting-compression-level/
---
## Введение

Управление большими файлами Excel может быть сложной задачей, особенно когда дело касается эффективности хранения и передачи. К счастью, сжатие файлов может значительно уменьшить размер этих файлов, что упрощает обработку. Если вы используете Aspose.Cells для .NET, у вас есть возможность легко настроить уровень сжатия ваших рабочих книг. Это руководство проведет вас через весь процесс шаг за шагом, предоставляя понятные объяснения каждой части кода.

## Предпосылки

Прежде чем мы углубимся в код, убедитесь, что у вас выполнены следующие предварительные условия:

1. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.
2.  Библиотека Aspose.Cells: Загрузите и установите библиотеку Aspose.Cells с сайта[здесь](https://releases.aspose.com/cells/net/).
3. Visual Studio: Для запуска кода необходима среда разработки, такая как Visual Studio.
4. .NET Framework: убедитесь, что ваш проект настроен на использование совместимой версии .NET Framework.

## Импорт необходимых пакетов

Для начала вам нужно импортировать необходимые пакеты в ваш проект C#. Добавьте следующие строки в начало вашего файла кода:

```csharp
using Aspose.Cells.Rendering;
using Aspose.Cells.WebExtensions;
using System;
```

 Эти пакеты необходимы для работы с файлами Excel с использованием библиотеки Aspose.Cells.`Aspose.Cells` Пространство имен содержит все классы, необходимые для работы с файлами Excel, в то время как`Aspose.Cells.Xlsb` предоставляет возможность сохранения файлов в формате XLSB.

## Шаг 1: Определите исходные и выходные каталоги

Сначала настройте каталоги, в которых находятся исходные файлы и куда вы хотите сохранять выходные файлы:

```csharp
// Определить исходные и выходные каталоги
string sourceDir = "Your Document Directory\\";
string outDir = "Your Document Directory\\";
```

 Обязательно замените`"Your Document Directory\\"` с реальными путями к вашим каталогам. Это гарантирует, что ваша программа сможет найти файлы, с которыми ей нужно работать.

## Шаг 2: Загрузите рабочую книгу

Затем загрузите книгу, которую вы хотите сжать:

```csharp
Workbook workbook = new Workbook(sourceDir + "LargeSampleFile.xlsx");
```

 Здесь мы создаем новый экземпляр`Workbook` class и загрузить существующий файл Excel. Убедитесь, что имя файла совпадает с именем в исходном каталоге.

## Шаг 3: Настройте параметры сохранения

Теперь настройте параметры сохранения вашей книги:

```csharp
XlsbSaveOptions options = new XlsbSaveOptions();
```

 The`XlsbSaveOptions`класс позволяет вам указывать различные параметры при сохранении вашей книги в формате XLSB, включая уровни сжатия.

## Шаг 4: Измерьте время сжатия для уровня 1

Начните с первого уровня сжатия и измерьте время, необходимое для сохранения книги:

```csharp
options.CompressionType = OoxmlCompressionType.Level1;
var watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_1_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 1 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

Этот фрагмент устанавливает тип сжатия на уровень 1, сохраняет книгу и измеряет прошедшее время.

## Шаг 5: Измерьте время сжатия для уровня 6

Далее протестируем производительность при сжатии уровня 6:

```csharp
options.CompressionType = OoxmlCompressionType.Level6;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_6_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 6 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

Этот шаг аналогичен предыдущему, но с более высоким уровнем сжатия.

## Шаг 6: Измерьте время сжатия для уровня 9

Наконец, оцените производительность при самом высоком уровне сжатия:

```csharp
options.CompressionType = OoxmlCompressionType.Level9;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_9_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 9 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

На этом этапе устанавливается уровень сжатия 9, при котором вы, скорее всего, увидите наиболее существенное уменьшение размера файла, хотя обработка может занять больше времени.

## Шаг 7: Окончательный результат

После завершения всех уровней сжатия выведите сообщение об успешном завершении процесса:

```csharp
Console.WriteLine("Compression adjustment completed successfully.");
```

Эта простая строка подтверждает, что ваша программа выполнена без проблем.

## Заключение

Настройка уровня сжатия ваших рабочих книг с помощью Aspose.Cells for .NET — это простой процесс, который может привести к значительному улучшению размера файла и производительности. Выполняя шаги, описанные в этом руководстве, вы сможете эффективно реализовать сжатие в своих приложениях, расширяя возможности управления файлами Excel.

## Часто задаваемые вопросы

### Что такое Aspose.Cells?  
Aspose.Cells — это мощная библиотека для .NET, которая позволяет разработчикам создавать, изменять и конвертировать файлы Excel без необходимости использования Microsoft Excel.

### Как установить Aspose.Cells?  
 Вы можете загрузить и установить Aspose.Cells с сайта[Сайт Aspose](https://releases.aspose.com/cells/net/).

### Какие уровни сжатия доступны?  
Aspose.Cells поддерживает несколько уровней сжатия: от уровня 1 (самое низкое сжатие) до уровня 9 (самое высокое сжатие).

### Могу ли я протестировать Aspose.Cells бесплатно?  
 Да! Вы можете получить бесплатную пробную версию Aspose.Cells[здесь](https://releases.aspose.com/).

### Где я могу найти поддержку Aspose.Cells?  
 По любым вопросам или для получения поддержки посетите форум поддержки Aspose[здесь](https://forum.aspose.com/c/cells/9).