---
title: Копирование данных в книгу Excel с помощью Aspose.Cells для .NET
linktitle: Копирование данных в книгу Excel с помощью Aspose.Cells для .NET
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как эффективно копировать данные в книге Excel с помощью Aspose.Cells для .NET. Следуйте этому пошаговому руководству, чтобы легко дублировать листы, переносить данные и легко управлять файлами Excel.
type: docs
weight: 12
url: /ru/net/tutorials/cells/mastering-worksheet-value-operations/copy-data-within-excel-workbook/
---
## Введение

В этом подробном руководстве мы покажем, как копировать данные в пределах одной и той же книги с помощью Aspose.Cells для .NET. Следуя пошаговым инструкциям, изложенным ниже, вы узнаете, как программно дублировать листы, сохраняя их содержимое и форматирование.

## Предварительные условия для копирования данных в Excel с помощью Aspose.Cells

Прежде чем приступить к написанию кода, давайте убедимся, что у вас все готово:

1. Библиотека Aspose.Cells for .NET: Вам необходимо установить библиотеку Aspose.Cells for .NET. Вы можете загрузить последнюю версию с[Страница загрузки Aspose.Cells для .NET](https://releases.aspose.com/cells/net/).
2. Среда разработки: для написания и запуска кода необходима совместимая с .NET среда разработки, например Visual Studio.
3.  Лицензия Aspose: Вы можете использовать либо бесплатную пробную версию, либо купленную лицензию. Для получения дополнительной информации посетите[здесь](https://purchase.aspose.com/temporary-license/).

После установки всех предварительных условий вы готовы приступить к работе с библиотекой.

## Импорт необходимых пакетов

Для начала вам нужно импортировать соответствующие пространства имен из Aspose.Cells. Это позволит вам работать с файлами Excel, используя классы и методы, предоставляемые Aspose.Cells.

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

 Эти пространства имен предоставят вам доступ к`Workbook` класс (для работы с файлами Excel) и`WorksheetCollection` (для доступа к нескольким листам в рабочей книге).

## Шаг 1: Инициализация путей к файлам для рабочей книги

Чтобы сохранить ваш код организованным, важно определить пути к файлам, где находится ваша рабочая книга и где вы собираетесь сохранить измененный файл. Вот как вы можете указать пути:

```csharp
// Определите путь к каталогу, где находится файл Excel.
string dataDir = "Your Directory Path";

// Определите полный путь к входной книге.
string inputPath = dataDir + "book1.xls";
```

 Заменять`"Your Directory Path"` с фактическим путем к вашему каталогу, содержащему рабочую книгу. Это помогает гарантировать гибкость кода и эффективное управление путями.

## Шаг 2: Откройте рабочую книгу для доступа к данным

 Теперь, когда пути к файлам заданы, следующим шагом будет загрузка книги Excel в`Workbook` объект. Это позволяет получить доступ к его содержимому для манипуляций.

```csharp
// Загрузите файл Excel в объект Workbook.
Workbook wb = new Workbook(inputPath);
```

 С помощью этой строки вы успешно загрузили`book1.xls` в`wb` объект, делая его данные доступными.

## Шаг 3: Получите доступ к коллекции рабочих листов

 После загрузки рабочей книги вы можете получить доступ к листам, содержащимся в ней. Aspose.Cells предоставляет`Worksheets`коллекция, которая позволяет взаимодействовать с каждым рабочим листом в рабочей книге.

```csharp
// Извлеките коллекцию рабочих листов из рабочей книги.
WorksheetCollection sheets = wb.Worksheets;
```

 The`sheets` объект теперь дает вам доступ ко всем рабочим листам внутри`book1.xls`, и вы можете выполнять над ними различные операции, включая копирование данных с одного листа на другой.

## Шаг 4: Копирование данных с одного листа на другой

 Для копирования данных с одного рабочего листа на другой в пределах одной рабочей книги Aspose.Cells предлагает простой в использовании метод, называемый`AddCopy`. Этот метод создает дубликат указанного рабочего листа и добавляет его в рабочую книгу.

```csharp
// Скопируйте данные с «Листа1» на новый лист рабочей книги.
sheets.AddCopy("Sheet1");
```

 В этом примере мы копируем данные с «Листа1» на новый лист.`AddCopy` метод дублирует весь лист, сохраняя все его содержимое, включая формулы, форматирование и значения.

## Шаг 5: Сохраните измененную рабочую книгу.

 После копирования данных вы можете сохранить измененную книгу под новым именем или в новом месте. Это делается путем вызова`Save`метод на`Workbook` объект.

```csharp
//Сохраните измененную книгу под новым именем.
wb.Save(dataDir + "book1_copy.xls");
```

 Это сохранит книгу со скопированным листом как`book1_copy.xls` в указанном каталоге. Вы можете изменить имя файла и путь в соответствии с вашими потребностями.

## Заключение

Копирование данных в рабочей книге Excel с помощью Aspose.Cells для .NET — простая задача, и это руководство содержит шаги, необходимые для эффективного выполнения этой задачи. Независимо от того, дублируете ли вы целые листы или определенные диапазоны данных, Aspose.Cells предлагает надежный и гибкий API, который делает автоматизацию Excel простой и эффективной.

## Часто задаваемые вопросы

### Могу ли я копировать несколько листов одновременно?

Aspose.Cells не поддерживает копирование нескольких листов за один вызов. Однако вы можете перебрать листы, которые хотите скопировать, и скопировать их по отдельности.

### Как переименовать скопированный лист?

После копирования листа вы можете переименовать его следующим образом:

```csharp
sheets[sheets.Count - 1].Name = "NewSheetName";
```

### Совместим ли Aspose.Cells с .NET Core?

Да, Aspose.Cells полностью совместим со средами .NET Framework и .NET Core.

### Как Aspose.Cells обрабатывает форматирование во время копирования?

 The`AddCopy`Метод сохраняет все содержимое и форматирование при копировании листов, гарантируя, что скопированные данные будут выглядеть идентично оригиналу.

### Могу ли я скопировать лист в другую книгу?

 Да, вы можете скопировать лист в другую книгу, используя`Copy` метод со ссылкой на целевую книгу.

```csharp
sheets.Add().Copy(wb.Worksheets["Sheet1"]);
```