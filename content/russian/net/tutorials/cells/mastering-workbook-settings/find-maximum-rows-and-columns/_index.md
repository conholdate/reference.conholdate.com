---
title: Найти максимальное количество строк и столбцов в форматах XLS и XLSX
linktitle: Найти максимальное количество строк и столбцов в форматах XLS и XLSX
second_title: API обработки Excel Aspose.Cells .NET
description: Узнайте, как эффективно управлять большими наборами данных в Excel, используя библиотеку Aspose.Cells for .NET. Это руководство предоставляет пошаговый подход к определению максимального количества строк и столбцов, поддерживаемых форматами файлов XLS и XLSX.
type: docs
weight: 11
url: /ru/net/tutorials/cells/mastering-workbook-settings/find-maximum-rows-and-columns/
---
## Введение

Управление большими наборами данных в Excel может быть сложной задачей, особенно в отношении ограничений различных форматов файлов. Это руководство проведет вас через использование библиотеки Aspose.Cells for .NET для определения максимального количества строк и столбцов, поддерживаемых форматами XLS (Excel 97-2003) и XLSX (Excel 2007 и более поздние версии). К концу вы будете оснащены для эффективного выполнения задач, связанных с Excel.

## Предпосылки

Перед началом убедитесь, что у вас есть следующее:

1. [.NET Framework](https://dotnet.microsoft.com/en-us/download) или[.NET Core](https://dotnet.microsoft.com/en-us/download) установлен в вашей системе.
2. [Aspose.Cells для .NET](https://releases.aspose.com/cells/net/) библиотеку, загруженную и указанную в вашем проекте (вы также можете установить ее через[NuGet](https://www.nuget.org/packages/Aspose.Cells/)).

## Импорт необходимых пакетов

Добавьте следующие операторы using в начало файла C#, чтобы импортировать необходимые пакеты из библиотеки Aspose.Cells:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

## Шаг 1: Максимальное количество строк и столбцов для формата XLS

Начнем с определения максимального количества строк и столбцов, поддерживаемых форматом XLS.

```csharp
// Распечатать сообщение о формате XLS.
Console.WriteLine("Maximum Rows and Columns supported by XLS format:");

// Создайте рабочую книгу в формате XLS.
Workbook wb = new Workbook(FileFormatType.Excel97To2003);

// Извлечь максимальное количество строк и столбцов.
int maxRows = wb.Settings.MaxRow + 1;
int maxCols = wb.Settings.MaxColumn + 1;

// Отобразите результаты.
Console.WriteLine("Maximum Rows: " + maxRows);
Console.WriteLine("Maximum Columns: " + maxCols);
Console.WriteLine();
```

1. Распечатать сообщение, указывающее, что мы работаем с форматом XLS.
2.  Создать`Workbook` экземпляр для формата XLS с использованием`FileFormatType.Excel97To2003`.
3.  Получите максимальное количество строк и столбцов с помощью`wb.Settings.MaxRow` и`wb.Settings.MaxColumn`, добавляя 1, поскольку они начинаются с нуля.
4. Вывести максимальное количество строк и столбцов на консоль.

## Шаг 2: Максимальное количество строк и столбцов для формата XLSX

Далее мы рассмотрим максимальное количество строк и столбцов, поддерживаемых форматом XLSX.

```csharp
// Распечатать сообщение о формате XLSX.
Console.WriteLine("Maximum Rows and Columns supported by XLSX format:");

// Создайте рабочую книгу в формате XLSX.
wb = new Workbook(FileFormatType.Xlsx);

// Извлечь максимальное количество строк и столбцов.
maxRows = wb.Settings.MaxRow + 1;
maxCols = wb.Settings.MaxColumn + 1;

// Отобразите результаты.
Console.WriteLine("Maximum Rows: " + maxRows);
Console.WriteLine("Maximum Columns: " + maxCols);
```

1. Вывести сообщение о том, что мы работаем с форматом XLSX.
2.  Создать`Workbook` экземпляр для формата XLSX с использованием`FileFormatType.Xlsx`.
3. Извлеките и выведите максимальное количество строк и столбцов, как и раньше.

## Шаг 3: Отображение сообщения об успешном завершении

После выполнения шагов отметим успех.

```csharp
Console.WriteLine("Execution completed successfully: Maximum Rows and Columns retrieval for both formats.");
```

## Заключение

В этом уроке вы узнали, как использовать библиотеку Aspose.Cells for .NET для поиска максимального количества строк и столбцов, поддерживаемых форматами файлов XLS и XLSX. Понимание этих ограничений необходимо для эффективного управления данными Excel, гарантируя, что ваши наборы данных соответствуют возможностям формата.

## Часто задаваемые вопросы

### Какое максимальное количество строк поддерживается форматом XLS?
Максимальное количество строк, поддерживаемых форматом XLS, составляет 65 536.

### Какое максимальное количество столбцов поддерживает формат XLS?
Максимальное количество столбцов, поддерживаемых форматом XLS, составляет 256.

### Какое максимальное количество строк поддерживается форматом XLSX?
Максимальное количество строк, поддерживаемых форматом XLSX, составляет 1 048 576.

### Какое максимальное количество столбцов поддерживает формат XLSX?
Максимальное количество столбцов, поддерживаемых форматом XLSX, составляет 16 384.

### Могу ли я использовать библиотеку Aspose.Cells for .NET с другими форматами файлов Excel?
 Да, Aspose.Cells for .NET поддерживает различные форматы файлов, включая XLS, XLSX, ODS и другие. Проверьте[документация](https://reference.aspose.com/cells/net/) для получения подробной информации о поддерживаемых функциях и возможностях.