---
title: Пользовательский порядок информации в MHTML с Aspose.Email
linktitle: Пользовательский порядок информации в MHTML с Aspose.Email
second_title: API обработки электронной почты Aspose.Email .NET
description: Узнайте, как определить индивидуальный порядок информации в MHTML с помощью Aspose.Email для .NET, в этом пошаговом руководстве.
type: docs
weight: 14
url: /ru/net/tutorials/email/mastering-email-header-manipulation/custom-order-of-information-in-mhtml/
---
## Введение

Создание расширенных форматов электронной почты может значительно улучшить коммуникацию, особенно при экспорте писем в различные форматы файлов, такие как MHTML. Aspose.Email для .NET предоставляет разработчикам мощный набор инструментов для управления электронными письмами, который включает определение пользовательского порядка отображения информации при экспорте в MHTML. В этом руководстве мы разберем шаги, необходимые для достижения этого, что упрощает выполнение, независимо от того, являетесь ли вы опытным разработчиком или только начинаете. Итак, давайте приступим!

## Предпосылки

Прежде чем приступить к определению индивидуального порядка информации в MHTML, необходимо проверить несколько предварительных условий в своем списке:

1. Среда разработки .NET: Убедитесь, что у вас настроена среда разработки .NET. Вы можете использовать Visual Studio, Visual Studio Code или любую другую совместимую IDE.

2.  Библиотека Aspose.Email: Вам необходимо установить библиотеку Aspose.Email for .NET. Вы можете загрузить последнюю версию с[Страница релизов Aspose](https://releases.aspose.com/email/net/).

3. Базовое понимание C#: знакомство с программированием на C# поможет вам лучше понимать код.

4.  Образец файла электронного письма: вам понадобится образец`.eml` файл (например,`Attachments.eml`) для целей тестирования.

Если у вас есть все эти предварительные условия, вы готовы приступить к изучению руководства!

## Импортные пакеты

Чтобы начать работу с кодом, вам нужно будет импортировать необходимые пространства имен из библиотеки Aspose.Email. Это необходимо для доступа ко всем классам и методам, необходимым для управления файлами электронной почты.

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Email.Mhtml;
```

Включите их в начало вашего файла C#. Теперь вы готовы погрузиться в кодирование!

Теперь, когда у вас все готово, давайте разобьем руководство на простые шаги.

## Шаг 1: Настройте каталог данных

Первое, что нужно сделать, это создать каталог, в котором будут храниться ваши файлы электронной почты. Это может быть любой путь на локальном компьютере.

```csharp
string dataDir = "Your Data Directory";
```

 Заменять`"Your Data Directory"` с фактическим путем, где ваш`.eml` файл находится. Например, если ваш файл находится в`C:\Emails`, вы бы написали:

```csharp
string dataDir = @"C:\Emails\";
```

## Шаг 2: Загрузите электронное письмо

Далее вам необходимо загрузить`.eml` файл в`MailMessage` объект. Это позволяет вам манипулировать содержимым и метаданными электронного письма.

```csharp
MailMessage eml = MailMessage.Load(dataDir + "Attachments.eml");
```

Убедитесь, что имя файла совпадает с тем, что у вас в указанном каталоге. Если у вашего файла другое имя, обновите имя файла соответствующим образом.

## Шаг 3: Настройте параметры сохранения MHTML

После загрузки вашего письма пришло время определить, как вы хотите сохранить его в формате MHTML. Вы можете начать с параметров по умолчанию.

```csharp
MhtSaveOptions opt = SaveOptions.DefaultMhtml;
```

Эта строка инициализирует параметры сохранения MHTML, подготавливая почву для последующей настройки заголовков.

## Шаг 4: Сохраните MHTML с порядком по умолчанию

Давайте сохраним письмо как MHTML, используя порядок по умолчанию. Это даст вам базовую линию для сравнения после настройки.

```csharp
eml.Save(dataDir + "CustomOrderOfInformationInMHTML_1.mhtml", opt);
```

 Запустите эту строку и проверьте указанный вами каталог. Теперь вы должны увидеть новый файл MHTML с именем`CustomOrderOfInformationInMHTML_1.mhtml`. Откройте его, чтобы увидеть, как информация отображается по умолчанию.

## Шаг 5: Настройте порядок заголовков

Теперь самое интересное! Вы можете указать, какие заголовки включать в вывод MHTML и в каком порядке. Начнем с некоторых распространенных заголовков.

```csharp
opt.RenderingHeaders.Add(MhtTemplateName.From);
opt.RenderingHeaders.Add(MhtTemplateName.Subject);
opt.RenderingHeaders.Add(MhtTemplateName.To);
opt.RenderingHeaders.Add(MhtTemplateName.Sent);
```

Добавляя эти заголовки, вы сообщаете Aspose, как вы хотите, чтобы отображалось электронное письмо.

## Шаг 6: Сохраните MHTML с индивидуальным заказом

После настройки заголовков вам необходимо снова сохранить электронное письмо в формате MHTML, чтобы увидеть, как новый порядок повлияет на вывод.

```csharp
eml.Save(dataDir + "CustomOrderOfInformationInMHTML_2.mhtml", opt);
```

 Запустите этот код, затем откройте`CustomOrderOfInformationInMHTML_2.mhtml`. Сравните его с первым, чтобы увидеть, как изменилась информация в зависимости от порядка заголовков.

## Шаг 7: Очистка и добавление нового порядка заголовков

А если вы хотите совсем другой порядок? Вы можете начать заново, очистив существующие настройки заголовка.

```csharp
opt.RenderingHeaders.Clear();
```

Теперь пришло время определить новый порядок заголовков. Например, если вы хотите установить приоритет вложений и копировать получателей:

```csharp
opt.RenderingHeaders.Add(MhtTemplateName.Attachments);
opt.RenderingHeaders.Add(MhtTemplateName.Cc);
opt.RenderingHeaders.Add(MhtTemplateName.Subject);
```

## Шаг 8: Сохраните MHTML с новым пользовательским заказом

Наконец, сохраните электронное письмо в последний раз с новыми настройками заголовка.

```csharp
eml.Save(dataDir + "CustomOrderOfInformationInMHTML_3.mhtml", opt);
```

 После запуска этой строки откройте`CustomOrderOfInformationInMHTML_3.mhtml`и проверьте, как он представляет информацию с учетом ваших новых настроек.

## Заключение

И вот вам — простое руководство по определению пользовательского порядка информации в MHTML с помощью Aspose.Email для .NET. Выполнив эти шаги, вы сможете контролировать, как ваши электронные письма будут представлены в формате MHTML, гарантируя, что самая важная информация будет представлена в соответствии с вашими потребностями. 

## Часто задаваемые вопросы

### Что такое MHTML?
MHTML означает «MIME HTML», формат архива веб-страниц, объединяющий HTML и другие ресурсы, такие как изображения.

### Могу ли я использовать Aspose.Email бесплатно?
 Да, Aspose предоставляет разработчикам бесплатную пробную версию для ознакомления. Вы можете найти ее[здесь](https://releases.aspose.com/).

### Что делать, если у меня возникнут проблемы при использовании Aspose.Email?
 Вы можете получить поддержку от сообщества через[Форум Aspose](https://forum.aspose.com/c/email/12/).

### Доступна ли временная лицензия для Aspose.Email?
 Да, вы можете подать заявление на получение временной лицензии.[здесь](https://purchase.aspose.com/temporary-license/).

### Где я могу купить Aspose.Email?
 Вы можете приобрести библиотеку здесь[связь](https://purchase.aspose.com/buy).